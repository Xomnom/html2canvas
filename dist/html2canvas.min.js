/*
  html2canvas 0.5.0-alpha2 <http://html2canvas.hertzen.com>
  Copyright (c) 2016 Niklas von Hertzen

  Released under MIT License
*/
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.html2canvas=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){!function(){"use strict";for(var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b=new Uint8Array(256),d=0;d<a.length;d++)b[a.charCodeAt(d)]=d;c.encode=function(b){var c,d=new Uint8Array(b),e=d.length,f="";for(c=0;e>c;c+=3)f+=a[d[c]>>2],f+=a[(3&d[c])<<4|d[c+1]>>4],f+=a[(15&d[c+1])<<2|d[c+2]>>6],f+=a[63&d[c+2]];return e%3===2?f=f.substring(0,f.length-1)+"=":e%3===1&&(f=f.substring(0,f.length-2)+"=="),f},c.decode=function(a){var c,d,e,f,g,h=.75*a.length,i=a.length,j=0;"="===a[a.length-1]&&(h--,"="===a[a.length-2]&&h--);var k=new ArrayBuffer(h),l=new Uint8Array(k);for(c=0;i>c;c+=4)d=b[a.charCodeAt(c)],e=b[a.charCodeAt(c+1)],f=b[a.charCodeAt(c+2)],g=b[a.charCodeAt(c+3)],l[j++]=d<<2|e>>4,l[j++]=(15&e)<<4|f>>2,l[j++]=(3&f)<<6|63&g;return k}}()},{}],2:[function(b,c,d){(function(d,e){(function(){"use strict";function f(a){return"function"==typeof a||"object"==typeof a&&null!==a}function g(a){return"function"==typeof a}function h(a){return"object"==typeof a&&null!==a}function i(a){U=a}function j(a){Y=a}function k(){var a=d.nextTick,b=d.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(b)&&"0"===b[1]&&"10"===b[2]&&(a=setImmediate),function(){a(p)}}function l(){return function(){T(p)}}function m(){var a=0,b=new _(p),c=document.createTextNode("");return b.observe(c,{characterData:!0}),function(){c.data=a=++a%2}}function n(){var a=new MessageChannel;return a.port1.onmessage=p,function(){a.port2.postMessage(0)}}function o(){return function(){setTimeout(p,1)}}function p(){for(var a=0;X>a;a+=2){var b=ca[a],c=ca[a+1];b(c),ca[a]=void 0,ca[a+1]=void 0}X=0}function q(){try{var a=b,c=a("vertx");return T=c.runOnLoop||c.runOnContext,l()}catch(d){return o()}}function r(){}function s(){return new TypeError("You cannot resolve a promise with itself")}function t(){return new TypeError("A promises callback cannot return that same promise.")}function u(a){try{return a.then}catch(b){return ga.error=b,ga}}function v(a,b,c,d){try{a.call(b,c,d)}catch(e){return e}}function w(a,b,c){Y(function(a){var d=!1,e=v(c,b,function(c){d||(d=!0,b!==c?z(a,c):B(a,c))},function(b){d||(d=!0,C(a,b))},"Settle: "+(a._label||" unknown promise"));!d&&e&&(d=!0,C(a,e))},a)}function x(a,b){b._state===ea?B(a,b._result):b._state===fa?C(a,b._result):D(b,void 0,function(b){z(a,b)},function(b){C(a,b)})}function y(a,b){if(b.constructor===a.constructor)x(a,b);else{var c=u(b);c===ga?C(a,ga.error):void 0===c?B(a,b):g(c)?w(a,b,c):B(a,b)}}function z(a,b){a===b?C(a,s()):f(b)?y(a,b):B(a,b)}function A(a){a._onerror&&a._onerror(a._result),E(a)}function B(a,b){a._state===da&&(a._result=b,a._state=ea,0!==a._subscribers.length&&Y(E,a))}function C(a,b){a._state===da&&(a._state=fa,a._result=b,Y(A,a))}function D(a,b,c,d){var e=a._subscribers,f=e.length;a._onerror=null,e[f]=b,e[f+ea]=c,e[f+fa]=d,0===f&&a._state&&Y(E,a)}function E(a){var b=a._subscribers,c=a._state;if(0!==b.length){for(var d,e,f=a._result,g=0;g<b.length;g+=3)d=b[g],e=b[g+c],d?H(c,d,e,f):e(f);a._subscribers.length=0}}function F(){this.error=null}function G(a,b){try{return a(b)}catch(c){return ha.error=c,ha}}function H(a,b,c,d){var e,f,h,i,j=g(c);if(j){if(e=G(c,d),e===ha?(i=!0,f=e.error,e=null):h=!0,b===e)return void C(b,t())}else e=d,h=!0;b._state!==da||(j&&h?z(b,e):i?C(b,f):a===ea?B(b,e):a===fa&&C(b,e))}function I(a,b){try{b(function(b){z(a,b)},function(b){C(a,b)})}catch(c){C(a,c)}}function J(a,b){var c=this;c._instanceConstructor=a,c.promise=new a(r),c._validateInput(b)?(c._input=b,c.length=b.length,c._remaining=b.length,c._init(),0===c.length?B(c.promise,c._result):(c.length=c.length||0,c._enumerate(),0===c._remaining&&B(c.promise,c._result))):C(c.promise,c._validationError())}function K(a){return new ia(this,a).promise}function L(a){function b(a){z(e,a)}function c(a){C(e,a)}var d=this,e=new d(r);if(!W(a))return C(e,new TypeError("You must pass an array to race.")),e;for(var f=a.length,g=0;e._state===da&&f>g;g++)D(d.resolve(a[g]),void 0,b,c);return e}function M(a){var b=this;if(a&&"object"==typeof a&&a.constructor===b)return a;var c=new b(r);return z(c,a),c}function N(a){var b=this,c=new b(r);return C(c,a),c}function O(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function P(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function Q(a){this._id=na++,this._state=void 0,this._result=void 0,this._subscribers=[],r!==a&&(g(a)||O(),this instanceof Q||P(),I(this,a))}function R(){var a;if("undefined"!=typeof e)a=e;else if("undefined"!=typeof self)a=self;else try{a=Function("return this")()}catch(b){throw new Error("polyfill failed because global object is unavailable in this environment")}var c=a.Promise;(!c||"[object Promise]"!==Object.prototype.toString.call(c.resolve())||c.cast)&&(a.Promise=oa)}var S;S=Array.isArray?Array.isArray:function(a){return"[object Array]"===Object.prototype.toString.call(a)};var T,U,V,W=S,X=0,Y=({}.toString,function(a,b){ca[X]=a,ca[X+1]=b,X+=2,2===X&&(U?U(p):V())}),Z="undefined"!=typeof window?window:void 0,$=Z||{},_=$.MutationObserver||$.WebKitMutationObserver,aa="undefined"!=typeof d&&"[object process]"==={}.toString.call(d),ba="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,ca=new Array(1e3);V=aa?k():_?m():ba?n():void 0===Z&&"function"==typeof b?q():o();var da=void 0,ea=1,fa=2,ga=new F,ha=new F;J.prototype._validateInput=function(a){return W(a)},J.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},J.prototype._init=function(){this._result=new Array(this.length)};var ia=J;J.prototype._enumerate=function(){for(var a=this,b=a.length,c=a.promise,d=a._input,e=0;c._state===da&&b>e;e++)a._eachEntry(d[e],e)},J.prototype._eachEntry=function(a,b){var c=this,d=c._instanceConstructor;h(a)?a.constructor===d&&a._state!==da?(a._onerror=null,c._settledAt(a._state,b,a._result)):c._willSettleAt(d.resolve(a),b):(c._remaining--,c._result[b]=a)},J.prototype._settledAt=function(a,b,c){var d=this,e=d.promise;e._state===da&&(d._remaining--,a===fa?C(e,c):d._result[b]=c),0===d._remaining&&B(e,d._result)},J.prototype._willSettleAt=function(a,b){var c=this;D(a,void 0,function(a){c._settledAt(ea,b,a)},function(a){c._settledAt(fa,b,a)})};var ja=K,ka=L,la=M,ma=N,na=0,oa=Q;Q.all=ja,Q.race=ka,Q.resolve=la,Q.reject=ma,Q._setScheduler=i,Q._setAsap=j,Q._asap=Y,Q.prototype={constructor:Q,then:function(a,b){var c=this,d=c._state;if(d===ea&&!a||d===fa&&!b)return this;var e=new this.constructor(r),f=c._result;if(d){var g=arguments[d-1];Y(function(){H(d,e,g,f)})}else D(c,e,a,b);return e},"catch":function(a){return this.then(null,a)}};var pa=R,qa={Promise:oa,polyfill:pa};"function"==typeof a&&a.amd?a(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:"undefined"!=typeof this&&(this.ES6Promise=qa),pa()}).call(this)}).call(this,b("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:3}],3:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],4:[function(b,c,d){(function(b){!function(e){function f(a){throw new RangeError(I[a])}function g(a,b){for(var c=a.length,d=[];c--;)d[c]=b(a[c]);return d}function h(a,b){var c=a.split("@"),d="";c.length>1&&(d=c[0]+"@",a=c[1]),a=a.replace(H,".");var e=a.split("."),f=g(e,b).join(".");return d+f}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d&&!d.nodeType&&d,s="object"==typeof c&&c&&!c.nodeType&&c,t="object"==typeof b&&b;(t.global===t||t.window===t||t.self===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^\x20-\x7E]/,H=/[\x2E\u3002\uFF0E\uFF61]/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.3.2",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&s)if(c.exports==r)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],5:[function(a,b,c){function d(a,b,c,d){this.x1=Number.NaN,this.y1=Number.NaN,this.x2=Number.NaN,this.y2=Number.NaN,Object.defineProperty(this,"x",{get:function(){return this.x1},set:function(a){this.x1=a}}),Object.defineProperty(this,"y",{get:function(){return this.y1},set:function(a){this.y1=a}}),Object.defineProperty(this,"width",{get:function(){return this.x2-this.x1}}),Object.defineProperty(this,"height",{get:function(){return this.y2-this.y1}}),this.addPoint(a,b),this.addPoint(c,d)}d.prototype.addPoint=function(a,b){null!=a&&((isNaN(this.x1)||isNaN(this.x2))&&(this.x1=a,this.x2=a),a<this.x1&&(this.x1=a),a>this.x2&&(this.x2=a)),null!=b&&((isNaN(this.y1)||isNaN(this.y2))&&(this.y1=b,this.y2=b),b<this.y1&&(this.y1=b),b>this.y2&&(this.y2=b))},d.prototype.inflate=function(a,b){b=b||a,this.x1-=a,this.y1-=b,this.x2+=a,this.y2+=b},d.prototype.clone=function(){return new d(this.x1,this.y1,this.x2,this.y2)},b.exports=d},{}],6:[function(a,b,c){function d(a,b,c){!a.defaultView||b===a.defaultView.pageXOffset&&c===a.defaultView.pageYOffset||a.defaultView.scrollTo(b,c)}function e(a,b){try{b&&(b.width=a.width,b.height=a.height,b.getContext("2d").putImageData(a.getContext("2d").getImageData(0,0,a.width,a.height),0,0))}catch(c){h("Unable to copy canvas content from",a,c)}}function f(a,b){for(var c=3===a.nodeType?document.createTextNode(a.nodeValue):a.cloneNode(!1),d=a.firstChild;d;)(b===!0||1!==d.nodeType||"SCRIPT"!==d.nodeName)&&c.appendChild(f(d,b)),d=d.nextSibling;return 1===a.nodeType&&(c._scrollTop=a.scrollTop,c._scrollLeft=a.scrollLeft,"CANVAS"===a.nodeName?e(a,c):("TEXTAREA"===a.nodeName||"SELECT"===a.nodeName)&&(c.value=a.value)),c}function g(a){if(1===a.nodeType){a.scrollTop=a._scrollTop,a.scrollLeft=a._scrollLeft;for(var b=a.firstChild;b;)g(b),b=b.nextSibling}}var h=a("./log"),i=a("./promise");b.exports=function(a,b,c,e,h,j,k){var l=f(a.documentElement,h.javascriptEnabled),m=b.createElement("iframe");return m.className="html2canvas-container",m.style.visibility="hidden",m.style.position="fixed",m.style.left="-10000px",m.style.top="0px",m.style.border="0",m.width=c,m.height=e,m.scrolling="no",b.body.appendChild(m),new i(function(b){var c=m.contentWindow.document;m.contentWindow.onload=m.onload=function(){var a=setInterval(function(){c.body.childNodes.length>0&&(g(c.documentElement),clearInterval(a),"view"===h.type&&(m.contentWindow.scrollTo(j,k),!/(iPad|iPhone|iPod)/g.test(navigator.userAgent)||m.contentWindow.scrollY===k&&m.contentWindow.scrollX===j||(c.documentElement.style.top=-k+"px",c.documentElement.style.left=-j+"px",c.documentElement.style.position="absolute")),b(m))},50)},c.open(),c.write("<!DOCTYPE html><html></html>"),d(a,j,k),c.replaceChild(c.adoptNode(l),c.documentElement),c.close()})}},{"./log":19,"./promise":22}],7:[function(a,b,c){function d(a){this.r=0,this.g=0,this.b=0,this.a=null;var b=this.fromArray(a)||this.namedColor(a)||this.rgb(a)||this.rgba(a)||this.hex6(a)||this.hex3(a)||null;this.isColor=null!==typeof b}d.prototype.darken=function(a){var b=1-a;return new d([Math.round(this.r*b),Math.round(this.g*b),Math.round(this.b*b),this.a])},d.prototype.isTransparent=function(){return 0===this.a},d.prototype.isBlack=function(){return 0===this.r&&0===this.g&&0===this.b},d.prototype.fromArray=function(a){return Array.isArray(a)&&(this.r=Math.min(a[0],255),this.g=Math.min(a[1],255),this.b=Math.min(a[2],255),a.length>3&&(this.a=a[3])),Array.isArray(a)};var e=/^#([a-f0-9]{3})$/i;d.prototype.hex3=function(a){var b=null;return null!==(b=a.match(e))&&(this.r=parseInt(b[1][0]+b[1][0],16),this.g=parseInt(b[1][1]+b[1][1],16),this.b=parseInt(b[1][2]+b[1][2],16)),null!==b};var f=/^#([a-f0-9]{6})$/i;d.prototype.hex6=function(a){var b=null;return null!==(b=a.match(f))&&(this.r=parseInt(b[1].substring(0,2),16),this.g=parseInt(b[1].substring(2,4),16),this.b=parseInt(b[1].substring(4,6),16)),null!==b};var g=/^rgb\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3})\)$/;d.prototype.rgb=function(a){var b=null;return null!==(b=a.match(g))&&(this.r=Number(b[1]),this.g=Number(b[2]),this.b=Number(b[3])),null!==b};var h=/^rgba\((\d{1,3}) *, *(\d{1,3}) *, *(\d{1,3}) *, *(\d+\.?\d*)\)$/;d.prototype.rgba=function(a){var b=null;return null!==(b=a.match(h))&&(this.r=Number(b[1]),this.g=Number(b[2]),this.b=Number(b[3]),this.a=Number(b[4])),null!==b},d.prototype.toString=function(){return null!==this.a&&1!==this.a?"rgba("+[this.r,this.g,this.b,this.a].join(",")+")":"rgb("+[this.r,this.g,this.b].join(",")+")"},d.prototype.namedColor=function(a){var b=i[a.toLowerCase()];if(b)this.r=b[0],this.g=b[1],this.b=b[2];else if("transparent"===a.toLowerCase())return this.r=this.g=this.b=this.a=0,!0;return!!b};var i={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};b.exports=d},{}],8:[function(a,b,c){function d(a){if(this.src=a,f("DummyImageContainer for",a),!this.promise||!this.image){f("Initiating DummyImageContainer"),d.prototype.image=new Image;var b=this.image;d.prototype.promise=new e(function(a,c){b.onload=a,b.onerror=c,b.src=g(),b.complete===!0&&a(b)})}}var e=a("./promise"),f=a("./log"),g=a("./utils").smallImage;b.exports=d},{"./log":19,"./promise":22,"./utils":34}],9:[function(a,b,c){function d(a,b){var c,d,f=document.createElement("div"),g=document.createElement("img"),h=document.createElement("span"),i="Hidden Text";f.style.visibility="hidden",f.style.fontFamily=a,f.style.fontSize=b,f.style.margin=0,f.style.padding=0,document.body.appendChild(f),g.src=e(),g.width=1,g.height=1,g.style.margin=0,g.style.padding=0,g.style.verticalAlign="baseline",h.style.fontFamily=a,h.style.fontSize=b,h.style.margin=0,h.style.padding=0,h.appendChild(document.createTextNode(i)),f.appendChild(h),f.appendChild(g),c=g.offsetTop-h.offsetTop+1,f.removeChild(h),f.appendChild(document.createTextNode(i)),f.style.lineHeight="normal",g.style.verticalAlign="super",d=g.offsetTop-f.offsetTop+1,document.body.removeChild(f),this.baseline=c,this.lineWidth=1,this.middle=d}var e=a("./utils").smallImage;b.exports=d},{"./utils":34}],10:[function(a,b,c){function d(){this.data={}}var e=a("./font");d.prototype.getMetrics=function(a,b){return void 0===this.data[a+"-"+b]&&(this.data[a+"-"+b]=new e(a,b)),this.data[a+"-"+b]},b.exports=d},{"./font":9}],11:[function(a,b,c){function d(b,c,d){this.image=null,this.src=b;var e=this,h=g(b);this.promise=(c?new f(function(a){"about:blank"===b.contentWindow.document.URL||null==b.contentWindow.document.documentElement?b.contentWindow.onload=b.onload=function(){a(b)}:a(b)}):this.proxyLoad(d.proxy,h,d)).then(function(b){var c=a("./");return c(b.contentWindow.document.documentElement,{type:"view",width:b.width,height:b.height,proxy:d.proxy,javascriptEnabled:d.javascriptEnabled,removeContainer:d.removeContainer,allowTaint:d.allowTaint,imageTimeout:d.imageTimeout/2})}).then(function(a){return e.image=a})}var e=a("./utils"),f=a("./promise"),g=e.getBounds,h=a("./proxy").loadUrlDocument;d.prototype.proxyLoad=function(a,b,c){var d=this.src;return h(d.src,a,d.ownerDocument,b.width,b.height,c)},b.exports=d},{"./":18,"./promise":22,"./proxy":23,"./utils":34}],12:[function(a,b,c){function d(a,b,c){this.src=JSON.stringify([a.value,c]),this.colorStops=[],this.type=null,this.x0=c.width/2,this.y0=c.height/2,this.x1=this.x0,this.y1=this.y0,this.promise=e.resolve(!0)}var e=a("../promise");d.prototype.TYPES={LINEAR:1,RADIAL:2},b.exports=d},{"../promise":22}],13:[function(a,b,c){function d(a,b){var c=b.parseBounds();e.call(this,a,b,c),this.type=this.TYPES.LINEAR;var d=-1===a.args[0].indexOf(this.stepRegExp);d?a.args[0].split(" ").reverse().forEach(function(b){switch(b){case"left":this.x0=0,this.x1=c.width;break;case"top":this.y0=0,this.y1=c.height;break;case"right":this.x0=c.width,this.x1=0;break;case"bottom":this.y0=c.height,this.y1=0;break;case"to":var d=this.y0,e=this.x0;this.y0=this.y1,this.x0=this.x1,this.x1=e,this.y1=d;break;default:if(-1!=b.indexOf("deg")){var f=parseFloat(b.substr(0,b.length-3));for("-webkit-"===a.prefix&&(f=90-f),f%=360;0>f;)f+=360;if(f%90===0){f||(this.y0=c.height,this.y1=0),90===f&&(this.x0=0,this.x1=c.width),180===f&&(this.y0=0,this.y1=c.height),270===f&&(this.x0=c.width,this.x1=0);break}var g,h=Math.tan((90-f)*(Math.PI/180)),i=-1/h,j=c.width/2,k=c.height/2;g=90>f?[j,k]:180>f?[j,-k]:270>f?[-j,-k]:[-j,k];var l=g[1]-i*g[0],m=l/(h-i),n=i*m+l;this.x0=j-m,this.y0=k+n,this.x1=j+m,this.y1=k-n}}},this):(this.y0=0,this.y1=c.height),this.colorStops=a.args.slice(d?1:0).map(function(a){var b=a.replace(/transparent/g,"rgba(0, 0, 0, 0.0)").match(this.stepRegExp);return{color:new f(b[1]),stop:"%"===b[3]?b[2]/100:null}},this),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(a,b){null===a.stop&&this.colorStops.slice(b).some(function(c,d){return null!==c.stop?(a.stop=(c.stop-this.colorStops[b-1].stop)/(d+1)+this.colorStops[b-1].stop,!0):!1},this)},this)}var e=a("./GradientContainer"),f=a("../color");d.prototype=Object.create(e.prototype),d.prototype.stepRegExp=/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/,b.exports=d},{"../color":7,"./GradientContainer":12}],14:[function(a,b,c){function d(a,b){var c=b.parseBounds();e.call(this,a,b,c),this.type=this.TYPES.RADIAL;var d=a.args,g=-1===d[0].indexOf(this.stepRegExp);if(g){"-webkit-"===a.prefix&&a.args.length>1&&-1===a.args[1].indexOf(this.stepRegExp)&&(d=[a.args[1]+" at "+a.args[0]].concat(a.args.slice(2)));var h=d[0].split("at")[0],i=d[0].split("at")[1]||"",j=h.match(this.lengthExp);if(j.length>0){if(j.length>1){var k=j[0].indexOf("%")>-1?parseFloat(j[0])/100*c.width:parseFloat(j[0]),l=j[1].indexOf("%")>-1?parseFloat(j[1])/100*c.height:parseFloat(j[1]);k=(c.width-b.borders.borders[1].width-b.borders.borders[3].width)*(k/c.width),l=(c.height-b.borders.borders[0].width-b.borders.borders[2].width)*(l/c.height),Math.min(k,l)===k?(this.r=k,this.scaleY=l/k):(this.r=l,this.scaleX=k/l)}else this.r=parseFloat(j[0]);this.x0=0,this.y0=0}else{var m,n="ellipse";h.split(" ").reverse().forEach(function(a){switch(a){case"circle":n="circle",m=m||"farthest-corner";break;case"ellipse":n="ellipse",m=m||"farthest-corner";break;case"closest-side":m="closest-side";break;case"closest-corner":m="closest-corner";break;case"farthest-side":m="farthest-side";break;case"farthest-corner":m="farthest-corner"}})}var o=i.match(this.lengthExp);if(o.length>1){var p=o[0].indexOf("%")>-1?parseFloat(o[0])/100*c.width:parseFloat(o[0]),q=o[1].indexOf("%")>-1?parseFloat(o[1])/100*c.height:parseFloat(o[1]);this.x0=this.x0+p,this.y0=this.y0+q}}this.colorStops=d.slice(g?1:0).map(function(a){var b=a.replace(/transparent/g,"rgba(0, 0, 0, 0.0)").match(this.stepRegExp);return{color:new f(b[1]),stop:"%"===b[3]?1-b[2]/100:null}},this),null===this.colorStops[0].stop&&(this.colorStops[0].stop=0),null===this.colorStops[this.colorStops.length-1].stop&&(this.colorStops[this.colorStops.length-1].stop=1),this.colorStops.forEach(function(a,b){null===a.stop&&this.colorStops.slice(b).some(function(c,d){return null!==c.stop?(a.stop=(c.stop-this.colorStops[b-1].stop)/(d+1)+this.colorStops[b-1].stop,!0):!1},this)},this)}var e=a("./GradientContainer"),f=a("../color");d.prototype=Object.create(e.prototype),d.prototype.lengthExp=/([0-9]+(?:px|%){1})/g,d.prototype.stepRegExp=/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/,b.exports=d},{"../color":7,"./GradientContainer":12}],15:[function(a,b,c){function d(a,b){e.call(this,a,b,b.parseBounds()),this.type="linear"===a.args[0]?this.TYPES.LINEAR:this.TYPES.RADIAL}var e=a("./GradientContainer");d.prototype=Object.create(e.prototype),b.exports=d},{"./GradientContainer":12}],16:[function(a,b,c){function d(a,b){this.src=a,this.image=new Image;var c=this;this.tainted=null,this.promise=new e(function(d,e){c.image.onload=d,c.image.onerror=e,b&&(c.image.crossOrigin="anonymous"),c.image.src=a,c.image.complete===!0&&d(c.image)})}var e=a("./promise");b.exports=d},{"./promise":22}],17:[function(a,b,c){function d(a,b){this.link=null,this.options=a,this.support=b,this.origin=this.getOrigin(window.location.href)}var e=a("./promise"),f=a("./log"),g=a("./imagecontainer"),h=a("./dummyimagecontainer"),i=a("./proxyimagecontainer"),j=a("./framecontainer"),k=a("./svg/SVGContainer"),l=a("./svg/SVGNodeContainer"),m=a("./gradient/LinearGradientContainer"),n=a("./gradient/RadialGradientContainer"),o=a("./gradient/WebKitGradientContainer"),p=a("./utils").bind;d.prototype.findImages=function(a){var b=[];return a.reduce(function(a,b){switch(b.node.nodeName){case"IMG":return a.concat([{args:[b.node.src],method:"url"}]);case"svg":case"IFRAME":return a.concat([{args:[b.node],method:b.node.nodeName}])}return a},[]).forEach(this.addImage(b,this.loadImage),this),b},d.prototype.findBackgroundImage=function(a,b){return b.parseBackgroundImages().filter(this.hasImageBackground).forEach(this.addImage(a,this.loadImage,b),this),a},d.prototype.addImage=function(a,b,c){return function(d){d.args.forEach(function(e){this.imageExists(a,e)||(a.splice(0,0,b.call(this,d,c)),f("Added image #"+a.length,"string"==typeof e?e.substring(0,100):e))},this)}},d.prototype.hasImageBackground=function(a){return"none"!==a.method},d.prototype.loadImage=function(a,b){if("url"===a.method){var c=a.args[0];return this.isSVG(c)&&!this.options.allowTaint?new k(c):c.match(/data:image\/.*;base64,/i)?new g(c.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),!1):this.isSameOrigin(c)||this.options.allowTaint===!0||this.isSVG(c)?new g(c,!1):this.support.cors&&!this.options.allowTaint?new g(c,!0):this.options.proxy?new i(c,this.options.proxy):new h(c)}return"linear-gradient"===a.method?new m(a,b):"radial-gradient"===a.method?new n(a,b):"gradient"===a.method?new o(a,b):"svg"===a.method?new l(a.args[0]):"IFRAME"===a.method?new j(a.args[0],this.isSameOrigin(a.args[0].src),this.options):new h(a)},d.prototype.isSVG=function(a){return"svg"===a.substring(a.length-3).toLowerCase()||k.prototype.isInline(a)},d.prototype.imageExists=function(a,b){return a.some(function(a){return a.src===b})},d.prototype.isSameOrigin=function(a){return this.getOrigin(a)===this.origin},d.prototype.getOrigin=function(a){var b=this.link||(this.link=document.createElement("a"));return b.href=a,b.href=b.href,b.protocol+b.hostname+b.port},d.prototype.getPromise=function(a){return this.timeout(a,this.options.imageTimeout)["catch"](function(){var b=new h(a.src);return b.promise.then(function(b){a.image=b})})},d.prototype.get=function(a){var b=null;return this.images.some(function(c){return(b=c).src===a})?b:null},d.prototype.fetch=function(a){return this.images=a.reduce(p(this.findBackgroundImage,this),this.findImages(a)),this.images.forEach(function(a,b){a.promise.then(function(){f("Succesfully loaded image #"+(b+1),a)},function(c){f("Failed loading image #"+(b+1),a,c)})}),this.ready=e.all(this.images.map(this.getPromise,this)),f("Finished searching images"),this},d.prototype.timeout=function(a,b){var c,d=e.race([a.promise,new e(function(d,e){c=setTimeout(function(){f("Timed out loading image",a),e(a)},b)})]).then(function(a){return clearTimeout(c),a});return d["catch"](function(){clearTimeout(c)}),d},b.exports=d},{"./dummyimagecontainer":8,"./framecontainer":11,"./gradient/LinearGradientContainer":13,"./gradient/RadialGradientContainer":14,"./gradient/WebKitGradientContainer":15,"./imagecontainer":16,"./log":19,"./promise":22,"./proxyimagecontainer":24,"./svg/SVGContainer":30,"./svg/SVGNodeContainer":31,"./utils":34}],18:[function(a,b,c){function d(a,b){function c(){var a=Array.prototype.slice.call(h.ownerDocument.body.childNodes).map(function(a){var b=s.getBounds(a);return[b.x+a.innerWidth,b.x+a.scrollWidth]}).reduce(function(a,b){return a.concat(b)},[]);return Math.max.apply(this,[h.scrollWidth,h.clientWidth,h.offsetWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth,document.documentElement.offsetWidth].concat(a).filter(function(a){return a}))}function f(){var a=Array.prototype.slice.call(h.ownerDocument.body.childNodes).map(function(a){var b=s.getBounds(a);return[b.y+a.innerHeight,b.y+a.scrollHeight]}).reduce(function(a,b){return a.concat(b)},[]);return Math.max.apply(this,[h.scrollHeight,h.clientHeight,h.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight].concat(a).filter(function(a){return a}))}var g=w++;if(b=b||{},b.debug||(d.logging=!0,d.start=Date.now()),b.async="undefined"==typeof b.async?!0:b.async,b.allowTaint="undefined"==typeof b.allowTaint?!1:b.allowTaint,b.removeContainer="undefined"==typeof b.removeContainer?!0:b.removeContainer,b.javascriptEnabled="undefined"==typeof b.javascriptEnabled?!1:b.javascriptEnabled,b.imageTimeout="undefined"==typeof b.imageTimeout?1e4:b.imageTimeout,b.renderer="function"==typeof b.renderer?b.renderer:m,b.strict=!!b.strict,"string"==typeof a)return r("Creating iframe for HTML contents"),new k(function(c){var e=document.createElement("iframe"),f=new Blob([a],{type:"text/html"}),g=URL.createObjectURL(f);
e.src=g,e.width=b.width||"100%",e.height=b.height||"100%",e.style.display="none",document.body.appendChild(e),e.onload=function(){var a=e.contentDocument||e.contentWindow.document;d(a.documentElement,b).then(function(a){document.body.removeChild(e),URL.revokeObjectURL(g),c(a)})}});var h=document.documentElement[0];a&&(h=a.length?a[0]:a),h.setAttribute(v+g,g);var i=null!=b.width?b.width:c(),j=null!=b.height?b.height:f();return e(h.ownerDocument,b,i,j,g).then(function(a){return"function"==typeof b.onrendered&&(r("options.onrendered is deprecated, html2canvas returns a Promise containing the canvas"),b.onrendered(a)),a})}function e(a,b,c,d,e){return t(a,a,c,d,b,a.defaultView.pageXOffset,a.defaultView.pageYOffset).then(function(g){r("Document cloned");var h=v+e,i="["+h+"='"+e+"']";a.querySelector(i).removeAttribute(h);var j=g.contentWindow,l=j.document.querySelector(i),m="function"==typeof b.onclone?k.resolve(b.onclone(j.document)):k.resolve(!0);return m.then(function(){return b.document=a,f(l,g,b,c,d)})})}function f(a,b,c,d,e){var f=b.contentWindow,k=new l(f.document),m=new n(c,k),p=u(a),s="view"===c.type?d:i(f.document),t="view"===c.type?e:j(f.document),v=new c.renderer(s,t,m,c),w=new o(a,v,k,m,c);return w.ready.then(function(){r("Finished rendering");var d;return d="view"===c.type?h(v.canvas,new q(0,0,v.canvas.width,v.canvas.height)):a===f.document.body||a===f.document.documentElement||null!=c.canvas?v.canvas:h(v.canvas,new q(p.x,p.y,null!=c.width?p.x+c.width:p.y+p.width,null!=c.width?p.y+c.width:p.y+p.width)),g(b,c),d})}function g(a,b){b.removeContainer&&(a.parentNode.removeChild(a),r("Cleaned up container"))}function h(a,b){var c=document.createElement("canvas"),d=Math.min(a.width-1,Math.max(0,b.x)),e=Math.min(a.width,Math.max(1,b.x+b.width)),f=Math.min(a.height-1,Math.max(0,b.y)),g=Math.min(a.height,Math.max(1,b.y+b.height));return c.width=b.width,c.height=b.height,r("Cropping canvas at:","left:",b.x,"top:",b.y,"width:",e-d,"height:",g-f),r("Resulting crop with width",b.width,"and height",b.height," with x",d,"and y",f),c.getContext("2d").drawImage(a,d,f,e-d,g-f,b.x,b.y,e-d,g-f),c}function i(a){return Math.max(Math.max(a.body.scrollWidth,a.documentElement.scrollWidth),Math.max(a.body.offsetWidth,a.documentElement.offsetWidth),Math.max(a.body.clientWidth,a.documentElement.clientWidth))}function j(a){return Math.max(Math.max(a.body.scrollHeight,a.documentElement.scrollHeight),Math.max(a.body.offsetHeight,a.documentElement.offsetHeight),Math.max(a.body.clientHeight,a.documentElement.clientHeight))}var k=a("./promise"),l=a("./support"),m=a("./renderer/CanvasRenderer"),n=a("./imageloader"),o=a("./nodeparser"),p=a("./nodecontainer"),q=a("./BoundingBox"),r=a("./log"),s=a("./utils"),t=a("./clone"),u=(a("./proxy").loadUrlDocument,s.getBounds),v="data-html2canvas-node",w=0;d.Promise=k,d.CanvasRenderer=m,d.NodeContainer=p,d.log=r,d.utils=s,b.exports="undefined"==typeof document||"function"!=typeof Object.create||"function"!=typeof document.createElement("canvas").getContext?function(){return k.reject("No canvas support")}:d},{"./BoundingBox":5,"./clone":6,"./imageloader":17,"./log":19,"./nodecontainer":20,"./nodeparser":21,"./promise":22,"./proxy":23,"./renderer/CanvasRenderer":26,"./support":29,"./utils":34}],19:[function(a,b,c){b.exports=function(){window.html2canvas.logging&&window.console&&window.console.log&&Function.prototype.bind.call(window.console.log,window.console).apply(window.console,[Date.now()-window.html2canvas.start+"ms","html2canvas:"].concat([].slice.call(arguments,0)))}},{}],20:[function(a,b,c){function d(a,b){this.node=a,this.parent=b,this.stack=null,this.bounds=null,this.borders=null,this.clip=[],this.backgroundClip=[],this.offsetBounds=null,this.visible=null,this.computedStyles=null,this.colors={},this.styles={},this.backgroundImages=null,this.transformData=null,this.transformMatrix=null,this.isPseudoElement=!1,this.opacity=null}function e(a){var b=a.options[a.selectedIndex||0];return b?b.text||"":""}function f(a){if(a&&"matrix"===a[1])return a[2].split(",").map(function(a){return parseFloat(a.trim())});if(a&&"matrix3d"===a[1]){var b=a[2].split(",").map(function(a){return parseFloat(a.trim())});return[b[0],b[1],b[4],b[5],b[12],b[13]]}}function g(a){return-1!==a.toString().indexOf("%")}function h(a){return a.replace("px","")}function i(a){return parseFloat(a)}var j=a("./color"),k=a("./BoundingBox"),l=a("./utils"),m=l.getBounds,n=l.parseBackgrounds,o=l.offsetBounds;d.prototype.cloneTo=function(a){a.visible=this.visible,a.borders=this.borders,a.bounds=this.bounds,a.clip=this.clip,a.backgroundClip=this.backgroundClip,a.computedStyles=this.computedStyles,a.styles=this.styles,a.backgroundImages=this.backgroundImages,a.opacity=this.opacity},d.prototype.getOpacity=function(){return null===this.opacity?this.opacity=this.cssFloat("opacity"):this.opacity},d.prototype.assignStack=function(a){this.stack=a,a.children.push(this)},d.prototype.isElementVisible=function(){return this.node.nodeType===Node.TEXT_NODE?this.parent.visible:"none"!==this.css("display")&&"hidden"!==this.css("visibility")&&!this.node.hasAttribute("data-html2canvas-ignore")&&("INPUT"!==this.node.nodeName||"hidden"!==this.node.getAttribute("type"))},d.prototype.css=function(a){return this.computedStyles||(this.computedStyles=this.isPseudoElement?this.parent.computedStyle(this.before?":before":":after"):this.computedStyle(null)),this.styles[a]||(this.styles[a]=this.computedStyles[a])},d.prototype.prefixedCss=function(a){var b=["webkit","moz","ms","o"],c=this.css(a);return void 0===c&&b.some(function(b){return c=this.css(b+a.substr(0,1).toUpperCase()+a.substr(1)),void 0!==c},this),void 0===c?null:c},d.prototype.computedStyle=function(a){return this.node.ownerDocument.defaultView.getComputedStyle(this.node,a)},d.prototype.cssInt=function(a){var b=parseInt(this.css(a),10);return isNaN(b)?0:b},d.prototype.color=function(a){return this.colors[a]||(this.colors[a]=new j(this.css(a)))},d.prototype.cssFloat=function(a){var b=parseFloat(this.css(a));return isNaN(b)?0:b},d.prototype.fontWeight=function(){var a=this.css("fontWeight");switch(parseInt(a,10)){case 401:a="bold";break;case 400:a="normal"}return a},d.prototype.parseClip=function(){var a=this.css("clip").match(this.CLIP);return a?new k(parseInt(a[4],10),parseInt(a[1],10),parseInt(a[2],10),parseInt(a[3],10)):null},d.prototype.parseBackgroundImages=function(){return this.backgroundImages||(this.backgroundImages=n(this.css("backgroundImage")))},d.prototype.cssList=function(a,b){var c=(this.css(a)||"").split(",");return c=c[b||0]||c[0]||"auto",c=c.trim().split(" "),1===c.length&&(c=[c[0],g(c[0])?"auto":c[0]]),c},d.prototype.parseBackgroundSize=function(a,b,c){var d,e,f=this.cssList("backgroundSize",c);if(g(f[0]))d=a.width*parseFloat(f[0])/100;else{if(/contain|cover/.test(f[0])){var h=a.width/a.height,i=b.width/b.height;return i>h^"contain"===f[0]?{width:a.height*i,height:a.height}:{width:a.width,height:a.width/i}}d=parseInt(f[0],10)}return e="auto"===f[0]&&"auto"===f[1]?b.height:"auto"===f[1]?d/b.width*b.height:g(f[1])?a.height*parseFloat(f[1])/100:parseInt(f[1],10),"auto"===f[0]&&(d=e/b.height*b.width),{width:d,height:e}},d.prototype.parseBackgroundPosition=function(a,b,c,d){var e,f,h=this.cssList("backgroundPosition",c);return e=g(h[0])?(a.width-(d||b).width)*(parseFloat(h[0])/100):parseInt(h[0],10),f="auto"===h[1]?e/b.width*b.height:g(h[1])?(a.height-(d||b).height)*parseFloat(h[1])/100:parseInt(h[1],10),"auto"===h[0]&&(e=f/b.height*b.width),new k(e,f)},d.prototype.parseBackgroundRepeat=function(a){return this.cssList("backgroundRepeat",a)[0]},d.prototype.SHADOW_PROPERTY=/(?!\([0-9\s.]+),(?![0-9\s.,]+\))/g,d.prototype.BOX_SHADOW_VALUES=/(inset)|(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,d.prototype.TEXT_SHADOW_VALUES=/(-?\d+px)|(#.+)|(rgb\(.+\))|(rgba\(.+\))/g,d.prototype.parseBoxShadows=function(){var a=this.css("boxShadow"),b=[];if(a&&"none"!==a)for(var c=a.split(this.SHADOW_PROPERTY),d=0;c&&d<c.length;d++){var e=c[d].match(this.BOX_SHADOW_VALUES),f="inset"===e[0]?1:0,g=new j(e[f]),h={color:g,offsetX:e[f+1]&&"inset"!==e[f+1]?parseFloat(e[f+1]):0,offsetY:e[f+2]&&"inset"!==e[f+2]?parseFloat(e[f+2]):0,blur:e[f+3]&&"inset"!==e[f+3]?parseFloat(e[f+3]):0,spread:e[f+4]&&"inset"!==e[f+4]?parseFloat(e[f+4]):0};(1===f||"inset"===e[e.length-1])&&(h.inset=!0),b.push(h)}return b},d.prototype.parseTextShadows=function(){var a=this.css("textShadow"),b=[];if(a&&"none"!==a)for(var c=a.split(this.SHADOW_PROPERTY),d=0;c&&d<c.length;d++){var e=c[d].match(this.TEXT_SHADOW_VALUES),f=e[0].indexOf("rgb")>-1?0:3,g=new j(e[f]);b.push({color:g,offsetX:e[(f+1)%4]?parseFloat(e[(f+1)%4].replace("px","")):0,offsetY:e[(f+2)%4]?parseFloat(e[(f+2)%4].replace("px","")):0,blur:e[(f+3)%4]?e[(f+3)%4].replace("px",""):0})}return b},d.prototype.parseTransform=function(){if(!this.transformData)if(this.hasTransform()){var a=this.parseBounds(),b=this.prefixedCss("transformOrigin").split(" ").map(h).map(i);b[0]+=a.x,b[1]+=a.y,this.transformData={origin:b,matrix:this.parseTransformMatrix()}}else this.transformData={origin:[0,0],matrix:[1,0,0,1,0,0]};return this.transformData},d.prototype.parseTransformMatrix=function(){if(!this.transformMatrix){var a=this.prefixedCss("transform"),b=a?f(a.match(this.MATRIX_PROPERTY)):null;this.transformMatrix=b?b:[1,0,0,1,0,0]}return this.transformMatrix},d.prototype.parseBounds=function(){return this.bounds||(this.bounds=this.hasTransform()?o(this.node):m(this.node))},d.prototype.hasTransform=function(){return"1,0,0,1,0,0"!==this.parseTransformMatrix().join(",")||this.parent&&this.parent.hasTransform()},d.prototype.getValue=function(){var a=this.node.value||"";return"SELECT"===this.node.tagName?a=e(this.node):"password"===this.node.type&&(a=Array(a.length+1).join("•")),0===a.length?this.node.placeholder||"":a},d.prototype.MATRIX_PROPERTY=/(matrix)\((.+)\)/,d.prototype.MATRIX_PROPERTY=/(matrix|matrix3d)\((.+)\)/,d.prototype.CLIP=/^rect\((\d+)px,? (\d+)px,? (\d+)px,? (\d+)px\)$/,b.exports=d},{"./BoundingBox":5,"./color":7,"./utils":34}],21:[function(a,b,c){function d(a,b,c,d,e){O("Starting NodeParser"),this.renderer=b,this.options=e,this.range=null,this.support=c,this.renderQueue=[],this.stack=new X(!0,1,a.ownerDocument,null);var f=new R(a,null);if(e.background&&b.rectangle(0,0,b.width,b.height,new V(e.background)),a===a.ownerDocument.documentElement){var g=new R(f.color("backgroundColor").isTransparent()?a.ownerDocument.body:a.ownerDocument.documentElement,null);b.rectangle(0,0,b.width,b.height,g.color("backgroundColor"))}f.visibile=f.isElementVisible(),this.createPseudoHideStyles(a.ownerDocument),this.disableAnimations(a.ownerDocument),this.nodes=J([f].concat(this.getChildren(f)).filter(function(a){return a.visible=a.isElementVisible()}).map(this.getPseudoElements,this)),this.fontMetrics=new U,O("Fetched nodes, total:",this.nodes.length),O("Calculate overflow clips"),this.calculateOverflowClips(),O("Start fetching images"),this.images=d.fetch(this.nodes.filter(B)),this.ready=this.images.ready.then(Z(function(){return O("Images loaded, starting parsing"),O("Creating stacking contexts"),this.createStackingContexts(),O("Sorting stacking contexts"),this.sortStackingContexts(this.stack),this.parse(this.stack),O("Render queue created with "+this.renderQueue.length+" items"),new W(Z(function(a){e.async?"function"==typeof e.async?e.async.call(this,this.renderQueue,a):this.renderQueue.length>0?(this.renderIndex=0,this.asyncRenderer(this.renderQueue,a)):a():(this.renderQueue.forEach(this.paint,this),a())},this))},this))}function e(a){return a.parent&&a.parent.clip.length}function f(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})}function g(){}function h(a,b,c,d){return a.map(function(e,f){if(e.width>0){var g=b.x,h=b.y,i=b.width,j=b.height-a[2].width;switch(f){case 0:j=a[0].width,e.args=l({c1:[g,h],c2:[g+i,h],c3:[g+i-a[1].width,h+j],c4:[g+a[3].width,h+j]},d[0],d[1],c.topLeftOuter,c.topLeftInner,c.topRightOuter,c.topRightInner);break;case 1:g=b.x+b.width-a[1].width,i=a[1].width,e.args=l({c1:[g+i,h],c2:[g+i,h+j+a[2].width],c3:[g,h+j],c4:[g,h+a[0].width]},d[1],d[2],c.topRightOuter,c.topRightInner,c.bottomRightOuter,c.bottomRightInner);break;case 2:h=h+b.height-a[2].width,j=a[2].width,e.args=l({c1:[g+i,h+j],c2:[g,h+j],c3:[g+a[3].width,h],c4:[g+i-a[3].width,h]},d[2],d[3],c.bottomRightOuter,c.bottomRightInner,c.bottomLeftOuter,c.bottomLeftInner);break;case 3:i=a[3].width,e.args=l({c1:[g,h+j+a[2].width],c2:[g,h],c3:[g+i,h+a[0].width],c4:[g+i,h+j]},d[3],d[0],c.bottomLeftOuter,c.bottomLeftInner,c.topLeftOuter,c.topLeftInner)}}return e})}function i(a,b,c,d){var e=4*((Math.sqrt(2)-1)/3),f=c*e,g=d*e,h=a+c,i=b+d;return{topLeft:k({x:a,y:i},{x:a,y:i-g},{x:h-f,y:b},{x:h,y:b}),topRight:k({x:a,y:b},{x:a+f,y:b},{x:h,y:i-g},{x:h,y:i}),bottomRight:k({x:h,y:b},{x:h,y:b+g},{x:a+f,y:i},{x:a,y:i}),bottomLeft:k({x:h,y:i},{x:h-f,y:i},{x:a,y:b+g},{x:a,y:b})}}function j(a,b,c){var d=a.x,e=a.y,f=a.width,g=a.height,h=b[0][0],j=b[0][1],k=b[1][0],l=b[1][1],m=b[2][0],n=b[2][1],o=b[3][0],p=b[3][1],q=f-k,r=g-n,s=f-m,t=g-p;return{topLeftOuter:i(d,e,h,j).topLeft.subdivide(.5),topLeftInner:i(d+c[3].width,e+c[0].width,Math.max(0,h-c[3].width),Math.max(0,j-c[0].width)).topLeft.subdivide(.5),topRightOuter:i(d+q,e,k,l).topRight.subdivide(.5),topRightInner:i(d+Math.min(q,f+c[3].width),e+c[0].width,q>f+c[3].width?0:k-c[3].width,l-c[0].width).topRight.subdivide(.5),bottomRightOuter:i(d+s,e+r,m,n).bottomRight.subdivide(.5),bottomRightInner:i(d+Math.min(s,f-c[3].width),e+Math.min(r,g+c[0].width),Math.max(0,m-c[1].width),n-c[2].width).bottomRight.subdivide(.5),bottomLeftOuter:i(d,e+t,o,p).bottomLeft.subdivide(.5),bottomLeftInner:i(d+c[3].width,e+t,Math.max(0,o-c[3].width),p-c[2].width).bottomLeft.subdivide(.5)}}function k(a,b,c,d){var e=function(a,b,c){return{x:a.x+(b.x-a.x)*c,y:a.y+(b.y-a.y)*c}};return{start:a,startControl:b,endControl:c,end:d,subdivide:function(f){var g=e(a,b,f),h=e(b,c,f),i=e(c,d,f),j=e(g,h,f),l=e(h,i,f),m=e(j,l,f);return[k(a,g,j,m),k(m,l,i,d)]},curveTo:function(a){a.push(["bezierCurve",b.x,b.y,c.x,c.y,d.x,d.y])},curveToReversed:function(d){d.push(["bezierCurve",c.x,c.y,b.x,b.y,a.x,a.y])}}}function l(a,b,c,d,e,f,g){var h=[];return b[0]>0||b[1]>0?(h.push(["line",d[1].start.x,d[1].start.y]),d[1].curveTo(h)):h.push(["line",a.c1[0],a.c1[1]]),c[0]>0||c[1]>0?(h.push(["line",f[0].start.x,f[0].start.y]),f[0].curveTo(h),h.push(["line",g[0].end.x,g[0].end.y]),g[0].curveToReversed(h)):(h.push(["line",a.c2[0],a.c2[1]]),h.push(["line",a.c3[0],a.c3[1]])),b[0]>0||b[1]>0?(h.push(["line",e[1].end.x,e[1].end.y]),e[1].curveToReversed(h)):h.push(["line",a.c4[0],a.c4[1]]),h}function m(a,b,c,d,e,f,g){b[0]>0||b[1]>0?(a.push(["line",d[0].start.x,d[0].start.y]),d[0].curveTo(a),d[1].curveTo(a)):a.push(["line",f,g]),(c[0]>0||c[1]>0)&&a.push(["line",e[0].start.x,e[0].start.y])}function n(a){return a.cssInt("zIndex")<0}function o(a){return a.cssInt("zIndex")>0}function p(a){return 0===a.cssInt("zIndex")}function q(a){return-1!==["inline","inline-block","inline-table"].indexOf(a.css("display"))}function r(a){return a instanceof X}function s(a){return a.node.data.trim().length>0}function t(a){return/^(normal|none|0px)$/.test(a.parent.css("letterSpacing"))}function u(a,b,c){return c=c||a.parseBounds(),["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(b){var d=a.css("border"+b+"Radius"),e=d.split(" ");return e.length<=1&&(e[1]=e[0]),e.forEach(function(a){var b=0===e.indexOf(a)?c.width:c.height;-1!==a.indexOf("%")&&(e[e.indexOf(a)]=G(a)/100*b)}),e.map(G)})}function v(a){return a.nodeType===Node.TEXT_NODE||a.nodeType===Node.ELEMENT_NODE}function w(a){var b=a.css("position"),c=-1!==["absolute","relative","fixed"].indexOf(b)?a.css("zIndex"):"auto";return"auto"!==c}function x(a){return"static"!==a.css("position")}function y(a){return"none"!==a.css("float")}function z(a){return-1!==["inline-block","inline-table"].indexOf(a.css("display"))}function A(a){var b=this;return function(){return!a.apply(b,arguments)}}function B(a){return a.node.nodeType===Node.ELEMENT_NODE}function C(a){return a.isPseudoElement===!0}function D(a){return a.node.nodeType===Node.TEXT_NODE}function E(a){return function(b,c){return b.cssInt("zIndex")+a.indexOf(b)/a.length-(c.cssInt("zIndex")+a.indexOf(c)/a.length)}}function F(a){return a.getOpacity()<1}function G(a){return parseFloat(a)}function H(a){return a.width}function I(a){return a.node.nodeType!==Node.ELEMENT_NODE||-1===["SCRIPT","HEAD","TITLE","OBJECT","BR","OPTION"].indexOf(a.node.nodeName)}function J(a){return[].concat.apply([],a)}function K(a){var b=a.substr(0,1);return b===a.substr(a.length-1)&&b.match(/'|"/)?a.substr(1,a.length-2):a}function L(a){for(var b,c=[],d=0,e=!1;a.length;)M(a[d])===e?(b=a.splice(0,d),b.length&&c.push(P.ucs2.encode(b)),e=!e,d=0):d++,d>=a.length&&(b=a.splice(0,d),b.length&&c.push(P.ucs2.encode(b)));return c}function M(a){return-1!==[32,13,10,9,45].indexOf(a)}function N(a){return/[^\u0000-\u00ff]/.test(a)}var O=a("./log"),P=a("punycode"),Q=a("./BoundingBox"),R=a("./nodecontainer"),S=a("./textcontainer"),T=a("./pseudoelementcontainer"),U=a("./fontmetrics"),V=a("./color"),W=a("./promise"),X=a("./stackingcontext"),Y=a("./utils"),Z=Y.bind,$=Y.getBounds,_=Y.parseBackgrounds,aa=Y.offsetBounds;d.prototype.calculateOverflowClips=function(){this.nodes.forEach(function(a){if(B(a)){C(a)&&a.appendToDOM(),a.borders=this.parseBorders(a);var b="hidden"===a.css("overflow")?[["transform",a.parseTransform()],a.borders.clip]:[["transform",a.parseTransform()]],c=a.parseClip();c&&-1!==["absolute","fixed"].indexOf(a.css("position"))&&b.push([["rect",a.bounds.x+c.x,a.bounds.y+c.y,c.x2-c.x,c.y2-c.y]]),a.clip=e(a)?a.parent.clip.concat(b):b,a.backgroundClip="hidden"!==a.css("overflow")?a.clip.concat([a.borders.clip]):a.clip,C(a)&&a.cleanDOM()}else D(a)&&(a.clip=e(a)?a.parent.clip:[]);C(a)||(a.bounds=null)},this)},d.prototype.asyncRenderer=function(a,b,c){c=c||Date.now(),this.paint(a[this.renderIndex++]),a.length===this.renderIndex?b():c+20>Date.now()?this.asyncRenderer(a,b,c):setTimeout(Z(function(){this.asyncRenderer(a,b)},this),0)},d.prototype.createPseudoHideStyles=function(a){this.createStyles(a,"."+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+':before { content: "" !important; display: none !important; }.'+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER+':after { content: "" !important; display: none !important; }')},d.prototype.disableAnimations=function(a){this.createStyles(a,"* { -webkit-animation: none !important; -moz-animation: none !important; -o-animation: none !important; animation: none !important; -webkit-transition: none !important; -moz-transition: none !important; -o-transition: none !important; transition: none !important;}")},d.prototype.createStyles=function(a,b){var c=a.createElement("style");c.innerHTML=b,a.body.appendChild(c)},d.prototype.getPseudoElements=function(a){var b=[[a]];if(a.node.nodeType===Node.ELEMENT_NODE){var c=this.getPseudoElement(a,":before"),d=this.getPseudoElement(a,":after");c&&b.push(c),d&&b.push(d)}return J(b)},d.prototype.getPseudoElement=function(a,b){var c=a.computedStyle(b);if(!c||!c.content||"none"===c.content||"-moz-alt-content"===c.content||"none"===c.display)return null;for(var d=K(c.content),e="url"===d.substr(0,3),g=document.createElement(e?"img":"html2canvaspseudoelement"),h=new T(g,a,b),i=c.length-1;i>=0;i--){var j=f(c.item(i));g.style[j]=c[j]}if(g.className=T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE+" "+T.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER,e)return g.src=_(d)[0].args[0],[h];var k=document.createTextNode(d);return g.appendChild(k),[h,new S(k,h)]},d.prototype.getChildren=function(a){return J([].filter.call(a.node.childNodes,v).map(function(b){var c=[b.nodeType===Node.TEXT_NODE?new S(b,a):new R(b,a)].filter(I);return b.nodeType===Node.ELEMENT_NODE&&c.length&&"TEXTAREA"!==b.tagName&&"svg"!==b.tagName?c[0].isElementVisible()?c.concat(this.getChildren(c[0])):[]:c},this))},d.prototype.newStackingContext=function(a,b){var c=new X(b,a.getOpacity(),a.node,a.parent);a.cloneTo(c);var d=b?c.getParentStack(this):c.parent.stack;d.contexts.push(c),a.stack=c},d.prototype.createStackingContexts=function(){this.nodes.forEach(function(a){B(a)&&(this.isRootElement(a)||F(a)||w(a)||this.isBodyWithTransparentRoot(a)||a.hasTransform())?this.newStackingContext(a,!0):B(a)&&(x(a)&&p(a)||z(a)||y(a))?this.newStackingContext(a,!1):a.assignStack(a.parent.stack)},this)},d.prototype.isBodyWithTransparentRoot=function(a){return"BODY"===a.node.nodeName&&a.parent.color("backgroundColor").isTransparent()},d.prototype.isRootElement=function(a){return null===a.parent},d.prototype.sortStackingContexts=function(a){a.contexts.sort(E(a.contexts.slice(0))),a.contexts.forEach(this.sortStackingContexts,this)},d.prototype.parseTextBounds=function(a){return function(b,c,d){if("none"!==a.parent.css("textDecoration").substr(0,4)||0!==b.trim().length){if(this.support.rangeBounds&&!a.parent.hasTransform()){var e=d.slice(0,c).join("").length;return this.getRangeBounds(a.node,e,b.length)}if(a.node&&"string"==typeof a.node.data){var f=a.node.splitText(b.length),g=this.getWrapperBounds(a.node,a.parent.hasTransform());return a.node=f,g}}else(!this.support.rangeBounds||a.parent.hasTransform())&&(a.node=a.node.splitText(b.length));return new Q}},d.prototype.getWrapperBounds=function(a,b){var c=a.ownerDocument.createElement("html2canvaswrapper"),d=a.parentNode,e=a.cloneNode(!0);c.appendChild(a.cloneNode(!0)),d.replaceChild(c,a);var f=b?aa(c):$(c);return d.replaceChild(e,c),f},d.prototype.getRangeBounds=function(a,b,c){var d=this.range||(this.range=a.ownerDocument.createRange());d.setStart(a,b),d.setEnd(a,b+c);var e=d.getBoundingClientRect();return new Q(e.left,e.top,e.right,e.bottom)},d.prototype.parse=function(a){var b=a.contexts.filter(n),c=a.children.filter(B),d=c.filter(A(y)),e=d.filter(A(x)).filter(A(q)),f=c.filter(A(x)).filter(y),h=d.filter(A(x)).filter(q),i=a.contexts.concat(d.filter(x)).filter(p),j=a.children.filter(D).filter(s),k=a.contexts.filter(o);b.concat(e).concat(f).concat(h).concat(i).concat(j).concat(k).forEach(function(a){this.renderQueue.push(a),r(a)&&(this.parse(a),this.renderQueue.push(new g))},this)},d.prototype.paint=function(a){try{a instanceof g?this.renderer.restore():D(a)?(C(a.parent)&&a.parent.appendToDOM(),this.paintText(a),C(a.parent)&&a.parent.cleanDOM()):this.paintNode(a)}catch(b){if(O(b),this.options.strict)throw b}},d.prototype.paintNode=function(a){r(a)&&(this.renderer.setOpacity(a.opacity),this.renderer.save(),this.renderer.setTransform(a.parseTransform())),"INPUT"===a.node.nodeName&&"checkbox"===a.node.type?this.paintCheckbox(a):"INPUT"===a.node.nodeName&&"radio"===a.node.type?this.paintRadio(a):this.paintElement(a)},d.prototype.paintElement=function(a){function b(){var b=this.images.get(a.node);b?this.renderer.renderImage(a,b.getBounds(c),a.borders,b):O("Error loading <"+a.node.nodeName+">",a.node)}var c=a.parseBounds(),d=a.parseBoxShadows();d.length>0&&d.forEach(function(b){if(!b.inset){b.blur=b.blur*this.renderer.getTransform().matrix[0];var d=b.color.a;b.color.a=255,this.renderer.setShadow(b.color.toString(),b.offsetX,b.offsetY,b.blur),b.color.a=d;var e=c.clone();e.inflate(b.spread),"content-box"===a.css("boxSizing")&&(e.x+=a.borders.borders[3].width,e.y+=a.borders.borders[0].width,e.x2-=a.borders.borders[1].width,e.y2-=2*a.borders.borders[2].width),e.x+=b.offsetX,e.y+=b.offsetY,e.x2+=b.offsetX,e.y2+=b.offsetY;var f=u(a,a.borders.borders,e),g=j(e,f,a.borders.borders);this.renderer.drawShape(this.parseBackgroundClip(a,g,a.borders.borders,f,e),b.color),this.renderer.clearShadow()}},this),this.renderer.clip(a.backgroundClip,function(){this.renderer.renderBackground(a,c,a.borders.borders.map(H))},this),this.renderer.clip(a.backgroundClip,function(){d.length>0&&d.forEach(function(b){if(b.inset){b.blur=b.blur*this.renderer.getTransform().matrix[0];var d=b.color.a;b.color.a=255,this.renderer.setShadow(b.color.toString(),0,0,b.blur),b.color.a=d,this.renderer.setFillStyle(b.color);var e=c.clone();e.inflate(-b.spread),"content-box"===a.css("boxSizing")&&(e.x+=a.borders.borders[3].width,e.y+=a.borders.borders[0].width,e.x2-=a.borders.borders[1].width,e.y2-=a.borders.borders[2].width),e.x+=b.offsetX,e.y+=b.offsetY,e.x2+=b.offsetX,e.y2+=b.offsetY;var f=u(a,a.borders.borders,e),g=j(e,f,a.borders.borders);this.renderer.shape(this.parseBackgroundClip(a,g,a.borders.borders,f,e)),this.renderer.ctx.rect(c.x-e.width,e.y-e.height,3*e.width,3*e.height),this.renderer.ctx.fill("evenodd"),this.renderer.clearShadow()}},this)},this),this.renderer.clip(a.clip,function(){this.renderer.renderBorders(a.borders.borders)},this),"svg"===a.node.nodeName&&("visible"===a.css("overflow")?b.bind(this)():this.renderer.clip(a.backgroundClip,function(){b.bind(this)()},this)),this.renderer.clip(a.backgroundClip,function(){switch(a.node.nodeName){case"IFRAME":var b=this.images.get(a.node);b?this.renderer.renderImage(a,c,a.borders,b):O("Error loading <"+a.node.nodeName+">",a.node);break;case"IMG":var d=this.images.get(a.node.src);d?this.renderer.renderImage(a,c,a.borders,d):O("Error loading <img>",a.node.src);break;case"CANVAS":this.renderer.renderImage(a,c,a.borders,{image:a.node});break;case"SELECT":case"INPUT":case"TEXTAREA":this.paintFormValue(a)}},this)},d.prototype.paintCheckbox=function(a){var b=a.parseBounds(),c=Math.min(b.width,b.height),d={width:c-1,height:c-1,top:b.y,left:b.x},e=[3,3],f=[e,e,e,e],g=[1,1,1,1].map(function(a){return{color:new V("#A5A5A5"),width:a}}),i=j(d,f,g);this.renderer.clip(a.backgroundClip,function(){this.renderer.rectangle(d.x+1,d.y+1,d.width-2,d.height-2,new V("#DEDEDE")),this.renderer.renderBorders(h(g,d,i,f)),a.node.checked&&(this.renderer.font(new V("#424242"),"normal","normal","bold",c-3+"px","arial"),this.renderer.text("✔",d.x+c/6,d.y+c-1))},this)},d.prototype.paintRadio=function(a){var b=a.parseBounds(),c=Math.min(b.width,b.height)-2;this.renderer.clip(a.backgroundClip,function(){this.renderer.circleStroke(b.x+1,b.y+1,c,new V("#DEDEDE"),1,new V("#A5A5A5")),a.node.checked&&this.renderer.circle(Math.ceil(b.x+c/4)+1,Math.ceil(b.y+c/4)+1,Math.floor(c/2),new V("#424242"))},this)},d.prototype.paintFormValue=function(a){var b=a.getValue();if(b.length>0){var c=a.node.ownerDocument,d=c.createElement("html2canvaswrapper"),e=["lineHeight","textAlign","fontFamily","fontWeight","fontSize","color","paddingLeft","paddingTop","paddingRight","paddingBottom","width","height","borderLeftStyle","borderTopStyle","borderLeftWidth","borderTopWidth","boxSizing","whiteSpace","wordWrap"];e.forEach(function(b){try{d.style[b]=a.css(b)}catch(c){O("html2canvas: Parse: Exception caught in renderFormValue: "+c.message)}});var f=a.parseBounds();d.style.position="fixed",d.style.x=f.x+"px",d.style.y=f.y+"px",d.textContent=b,c.body.appendChild(d),this.paintText(new S(d.firstChild,a)),c.body.removeChild(d)}},d.prototype.paintText=function(a){a.applyTextTransform();var b=P.ucs2.decode(a.node.data),c=this.options.letterRendering&&!t(a)||N(a.node.data)?b.map(function(a){return P.ucs2.encode([a])}):L(b),d=a.parent.fontWeight(),e=a.parent.css("fontSize"),f=a.parent.css("fontFamily"),g=a.parent.parseTextShadows();this.renderer.font(a.parent.color("color"),a.parent.css("fontStyle"),a.parent.css("fontVariant"),d,e,f),g.length?this.renderer.setShadow(g[0].color,g[0].offsetX,g[0].offsetY,g[0].blur):this.renderer.clearShadow(),this.renderer.clip(a.parent.clip,function(){c.map(this.parseTextBounds(a),this).forEach(function(b,d){b&&(this.renderer.text(c[d],b.x,b.y2),this.renderTextDecoration(a.parent,b,this.fontMetrics.getMetrics(f,e)))},this)},this)},d.prototype.renderTextDecoration=function(a,b,c){switch(a.css("textDecoration").split(" ")[0]){case"underline":this.renderer.rectangle(b.x,Math.round(b.y+c.baseline+c.lineWidth),b.width,1,a.color("color"));break;case"overline":this.renderer.rectangle(b.x,Math.round(b.y),b.width,1,a.color("color"));break;case"line-through":this.renderer.rectangle(b.x,Math.ceil(b.y+c.middle+c.lineWidth),b.width,1,a.color("color"))}};var ba={inset:[["darken",.6],["darken",.1],["darken",.1],["darken",.6]]};d.prototype.parseBorders=function(a){var b=a.parseBounds(),c=["Top","Right","Bottom","Left"].map(function(b,c){var d=a.css("border"+b+"Style"),e=a.color("border"+b+"Color");"inset"===d&&e.isBlack()&&(e=new V([255,255,255,e.a]));var f=ba[d]?ba[d][c]:null;return{width:a.cssInt("border"+b+"Width"),color:f?e[f[0]](f[1]):e,args:null}}),d=u(a,c),e=j(b,d,c);return{clip:this.parseBackgroundClip(a,e,c,d,b),borders:h(c,b,e,d)}},d.prototype.parseBackgroundClip=function(a,b,c,d,e){var f=a.css("backgroundClip"),g=[];switch(f){case"content-box":case"padding-box":m(g,d[0],d[1],b.topLeftInner,b.topRightInner,e.x+c[3].width,e.y+c[0].width),m(g,d[1],d[2],b.topRightInner,b.bottomRightInner,e.x+e.width-c[1].width,e.y+c[0].width),m(g,d[2],d[3],b.bottomRightInner,b.bottomLeftInner,e.x+e.width-c[1].width,e.y+e.height-c[2].width),m(g,d[3],d[0],b.bottomLeftInner,b.topLeftInner,e.x+c[3].width,e.y+e.height-c[2].width);break;default:m(g,d[0],d[1],b.topLeftOuter,b.topRightOuter,e.x,e.y),m(g,d[1],d[2],b.topRightOuter,b.bottomRightOuter,e.x+e.width,e.y),m(g,d[2],d[3],b.bottomRightOuter,b.bottomLeftOuter,e.x+e.width,e.y+e.height),m(g,d[3],d[0],b.bottomLeftOuter,b.topLeftOuter,e.x,e.y+e.height)}return g},b.exports=d},{"./BoundingBox":5,"./color":7,"./fontmetrics":10,"./log":19,"./nodecontainer":20,"./promise":22,"./pseudoelementcontainer":25,"./stackingcontext":28,"./textcontainer":33,"./utils":34,punycode:4}],22:[function(a,b,c){b.exports=a("es6-promise").Promise},{"es6-promise":2}],23:[function(a,b,c){function d(a,b,c){var d="withCredentials"in new XMLHttpRequest;if(!b)return k.reject("No proxy configured");var e=g(d),i=h(b,a,e);return d?l(i):f(c,i,e).then(function(a){return p(a.content)})}function e(a,b,c){var d="crossOrigin"in new Image,e=g(d),i=h(b,a,e);return d?k.resolve(i):f(c,i,e).then(function(a){return"data:"+a.type+";base64,"+a.content})}function f(a,b,c){return new k(function(d,e){var f=a.createElement("script"),g=function(){delete window.html2canvas.proxy[c],a.body.removeChild(f)};window.html2canvas.proxy[c]=function(a){g(),d(a)},f.src=b,f.onerror=function(a){g(),e(a)},a.body.appendChild(f)})}function g(a){return a?"":"html2canvas_"+Date.now()+"_"+ ++q+"_"+Math.round(1e5*Math.random())}function h(a,b,c){return a+"?url="+encodeURIComponent(b)+(c.length?"&callback=html2canvas.proxy."+c:"")}function i(a){return function(b){var c,d=new DOMParser;try{c=d.parseFromString(b,"text/html")}catch(e){n("DOMParser not supported, falling back to createHTMLDocument"),c=document.implementation.createHTMLDocument("");try{c.open(),c.write(b),c.close()}catch(f){n("createHTMLDocument write not supported, falling back to document.body.innerHTML"),c.body.innerHTML=b}}var g=c.querySelector("base");if(!g||!g.href.host){var h=c.createElement("base");h.href=a,c.head.insertBefore(h,c.head.firstChild)}return c}}function j(a,b,c,e,f,g){return new d(a,b,window.document).then(i(a)).then(function(a){return o(a,c,e,f,g,0,0)})}var k=a("./promise"),l=a("./xhr"),m=a("./utils"),n=a("./log"),o=a("./clone"),p=m.decode64,q=0;c.Proxy=d,c.ProxyURL=e,c.loadUrlDocument=j},{"./clone":6,"./log":19,"./promise":22,"./utils":34,"./xhr":35}],24:[function(a,b,c){function d(a,b){var c=document.createElement("a");c.href=a,a=c.href,this.src=a,this.image=new Image;var d=this;this.promise=new f(function(c,f){d.image.crossOrigin="Anonymous",d.image.onload=c,d.image.onerror=f,new e(a,b,document).then(function(a){d.image.src=a})["catch"](f)})}var e=a("./proxy").ProxyURL,f=a("./promise");b.exports=d},{"./promise":22,"./proxy":23}],25:[function(a,b,c){function d(a,b,c){e.call(this,a,b),this.isPseudoElement=!0,this.before=":before"===c}var e=a("./nodecontainer");d.prototype.cloneTo=function(a){d.prototype.cloneTo.call(this,a),a.isPseudoElement=!0,a.before=this.before},d.prototype=Object.create(e.prototype),d.prototype.appendToDOM=function(){this.before?this.parent.node.insertBefore(this.node,this.parent.node.firstChild):this.parent.node.appendChild(this.node),
this.parent.node.className+=" "+this.getHideClass()},d.prototype.cleanDOM=function(){this.node.parentNode.removeChild(this.node),this.parent.node.className=this.parent.node.className.replace(this.getHideClass(),"")},d.prototype.getHideClass=function(){return this["PSEUDO_HIDE_ELEMENT_CLASS_"+(this.before?"BEFORE":"AFTER")]},d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_BEFORE="___html2canvas___pseudoelement_before",d.prototype.PSEUDO_HIDE_ELEMENT_CLASS_AFTER="___html2canvas___pseudoelement_after",b.exports=d},{"./nodecontainer":20}],26:[function(a,b,c){function d(a,b,c,d){f.apply(this,arguments),this.canvas=this.options.canvas||document.createElement("canvas"),this.options.canvas||(this.canvas.width=a,this.canvas.height=b),this.ctx=this.canvas.getContext("2d"),this.taintCtx=document.createElement("canvas").getContext("2d"),this.ctx.textBaseline="bottom",this.variables={},this.transforms={},this.stackDepth=1,i("Initialized CanvasRenderer with size",a,"x",b)}function e(a){return a.length>0}var f=a("./Renderer"),g=a("../gradient/LinearGradientContainer"),h=a("../gradient/RadialGradientContainer"),i=a("../log");d.prototype=Object.create(f.prototype),d.prototype.save=function(){this.ctx.save(),this.stackDepth++},d.prototype.restore=function(){this.ctx.restore(),delete this.transforms[this.stackDepth.toString()],this.stackDepth--},d.prototype.setFillStyle=function(a){return this.ctx.fillStyle="object"==typeof a&&a.isColor?a.toString():a,this.ctx},d.prototype.rectangle=function(a,b,c,d,e){this.setFillStyle(e).fillRect(a,b,c,d)},d.prototype.circle=function(a,b,c,d){this.setFillStyle(d),this.ctx.beginPath(),this.ctx.arc(a+c/2,b+c/2,c/2,0,2*Math.PI,!0),this.ctx.closePath(),this.ctx.fill()},d.prototype.circleStroke=function(a,b,c,d,e,f){this.circle(a,b,c,d),this.ctx.strokeStyle=f.toString(),this.ctx.stroke()},d.prototype.drawShape=function(a,b){this.shape(a),this.setFillStyle(b).fill()},d.prototype.taints=function(a){if(null===a.tainted){this.taintCtx.drawImage(a.image,0,0);try{this.taintCtx.getImageData(0,0,1,1),a.tainted=!1}catch(b){this.taintCtx=document.createElement("canvas").getContext("2d"),a.tainted=!0}}return a.tainted},d.prototype.drawImage=function(a,b,c,d,e,f,g,h,i){(!this.taints(a)||this.options.allowTaint)&&this.ctx.drawImage(a.image,b,c,d,e,f,g,h,i)},d.prototype.clip=function(a,b,c){0!==a.length&&(this.save(),this.ctx.setTransform(1,0,0,1,0,0),a.filter(e).forEach(function(a){return"transform"===a[0]?void this.setTransform(a[1]):void this.shape(a).clip()},this),b.call(c),this.restore())},d.prototype.shape=function(a){return this.ctx.beginPath(),a.forEach(function(a,b){"rect"===a[0]?this.ctx.rect.apply(this.ctx,a.slice(1)):this.ctx[0===b?"moveTo":a[0]+"To"].apply(this.ctx,a.slice(1))},this),this.ctx.closePath(),this.ctx},d.prototype.font=function(a,b,c,d,e,f){this.setFillStyle(a).font=[b,c,d,e,f].join(" ").split(",")[0]},d.prototype.setShadow=function(a,b,c,d){this.setVariable("shadowColor",a.toString()).setVariable("shadowOffsetX",b).setVariable("shadowOffsetY",c).setVariable("shadowBlur",d)},d.prototype.clearShadow=function(){this.setVariable("shadowColor","rgba(0,0,0,0)")},d.prototype.setOpacity=function(a){this.ctx.globalAlpha=a},d.prototype.getTransform=function(){for(var a=this.stackDepth;--a>0;)if("undefined"!=typeof this.transforms[a.toString()]){var b=this.transforms[a.toString()];if("undefined"!=typeof b.x1)continue;if("1,0,0,1,0,0"===b.matrix.join(","))continue;return b}return{origin:[0,0],matrix:[1,0,0,1,0,0]}},d.prototype.setTransform=function(a){this.ctx.translate(a.origin[0],a.origin[1]),this.transforms[this.stackDepth.toString()]=a,this.ctx.transform.apply(this.ctx,a.matrix),this.ctx.translate(-a.origin[0],-a.origin[1])},d.prototype.setVariable=function(a,b){return this.variables[a]!==b&&(this.variables[a]=this.ctx[a]=b),this},d.prototype.text=function(a,b,c){this.ctx.fillText(a,b,c)},d.prototype.backgroundRepeatShape=function(a,b,c,d,e,f,g,h,i){var j=[["line",Math.round(e),Math.round(f)],["line",Math.round(e+g),Math.round(f)],["line",Math.round(e+g),Math.round(h+f)],["line",Math.round(e),Math.round(h+f)]];this.clip([j],function(){this.renderBackgroundRepeat(a,b,c,d,i[3],i[0])},this)},d.prototype.renderBackgroundRepeat=function(a,b,c,d,e,f){var g=Math.round(d.x+b.x+e),h=Math.round(d.y+b.y+f);this.setFillStyle(this.ctx.createPattern(this.resizeImage(a,c),"repeat")),this.ctx.translate(g,h),this.ctx.fill(),this.ctx.translate(-g,-h)},d.prototype.renderBackgroundGradient=function(a,b){var c;if(a instanceof g)c=this.ctx.createLinearGradient(b.x+a.x0,b.y+a.y0,b.x+a.x1,b.y+a.y1);else if(a instanceof h){if("undefined"!=typeof a.scaleX||"undefined"!=typeof a.scaleY){a.scaleX=a.scaleX||1,a.scaleY=a.scaleY||1,c=this.ctx.createRadialGradient((b.x+a.x0)/a.scaleX,(b.y+a.y0)/a.scaleY,a.r,(b.x+a.x0)/a.scaleX,(b.y+a.y0)/a.scaleY,0),a.colorStops.forEach(function(a){c.addColorStop(a.stop,a.color.toString())});var d=this.ctx.currentTransform;return this.ctx.setTransform(a.scaleX,0,0,a.scaleY,0,0),this.rectangle(b.x/a.scaleX,b.y/a.scaleY,b.width,b.height,c),void(this.ctx.currentTransform=d)}c=this.ctx.createRadialGradient(b.x+a.x0,b.y+a.y0,a.r,b.x+a.x0,b.y+a.y0,0)}a.colorStops.forEach(function(a){c.addColorStop(a.stop,a.color.toString())}),this.rectangle(b.x,b.y,b.width,b.height,c)},d.prototype.resizeImage=function(a,b){var c=a.image;if(c.width===b.width&&c.height===b.height)return c;var d,e=document.createElement("canvas");return e.width=b.width,e.height=b.height,d=e.getContext("2d"),d.drawImage(c,0,0,c.width,c.height,0,0,b.width,b.height),e},b.exports=d},{"../gradient/LinearGradientContainer":13,"../gradient/RadialGradientContainer":14,"../log":19,"./Renderer":27}],27:[function(a,b,c){function d(a,b,c,d){this.width=a,this.height=b,this.images=c,this.options=d}var e=a("../log");d.prototype.renderImage=function(a,b,c,d){var e=a.cssInt("paddingLeft"),f=a.cssInt("paddingTop"),g=a.cssInt("paddingRight"),h=a.cssInt("paddingBottom"),i=c.borders,j=b.width-(i[1].width+i[3].width+e+g),k=b.height-(i[0].width+i[2].width+f+h);this.drawImage(d,0,0,d.image.width||j,d.image.height||k,b.x+e+i[3].width,b.y+f+i[0].width,j,k)},d.prototype.renderBackground=function(a,b,c){b.height>0&&b.width>0&&(this.renderBackgroundColor(a,b),this.renderBackgroundImage(a,b,c))},d.prototype.renderBackgroundColor=function(a,b){var c=a.color("backgroundColor");c.isTransparent()||this.rectangle(b.x,b.y,b.width,b.height,c)},d.prototype.renderBorders=function(a){a.forEach(this.renderBorder,this)},d.prototype.renderBorder=function(a){a.color.isTransparent()||null===a.args||this.drawShape(a.args,a.color)},d.prototype.renderBackgroundImage=function(a,b,c){var d=a.parseBackgroundImages();d.reverse().forEach(function(d,f,g){switch(d.method){case"url":var h=this.images.get(d.args[0]);h?this.renderBackgroundRepeating(a,b,h,g.length-(f+1),c):e("Error loading background-image",d.args[0]);break;case"linear-gradient":case"radial-gradient":case"gradient":var i=JSON.stringify([d.value,b]),j=this.images.get(i);j?this.renderBackgroundGradient(j,b,c):e("Error loading background-image",i);break;case"none":break;default:e("Unknown background-image type",d.args[0])}},this)},d.prototype.renderBackgroundRepeating=function(a,b,c,d,e){var f=a.parseBackgroundSize(b,c.image,d),g=a.parseBackgroundPosition(b,c.image,d,f),h=a.parseBackgroundRepeat(d);switch(h){case"repeat-x":case"repeat no-repeat":this.backgroundRepeatShape(c,g,f,b,b.x+e[3],b.y+g.y+e[0],99999,f.height,e);break;case"repeat-y":case"no-repeat repeat":this.backgroundRepeatShape(c,g,f,b,b.x+g.x+e[3],b.y+e[0],f.width,99999,e);break;case"no-repeat":this.backgroundRepeatShape(c,g,f,b,b.x+g.x+e[3],b.y+g.y+e[0],f.width,f.height,e);break;default:this.renderBackgroundRepeat(c,g,f,{y:b.y,x:b.x},e[3],e[0])}},b.exports=d},{"../log":19}],28:[function(a,b,c){function d(a,b,c,d){e.call(this,c,d),this.ownStacking=a,this.contexts=[],this.children=[],this.opacity=(this.parent?this.parent.stack.opacity:1)*b}var e=a("./nodecontainer");d.prototype=Object.create(e.prototype),d.prototype.getParentStack=function(a){var b=this.parent?this.parent.stack:null;return b?b.ownStacking?b:b.getParentStack(a):a.stack},b.exports=d},{"./nodecontainer":20}],29:[function(a,b,c){function d(a){this.rangeBounds=this.testRangeBounds(a),this.cors=this.testCORS()}d.prototype.testRangeBounds=function(a){var b,c,d,e,f=!1;return a.createRange&&(b=a.createRange(),b.getBoundingClientRect&&(c=a.createElement("boundtest"),c.style.height="123px",c.style.display="block",a.body.appendChild(c),b.selectNode(c),d=b.getBoundingClientRect(),e=d.height,123===Math.round(e)&&(f=!0),a.body.removeChild(c))),f},d.prototype.testCORS=function(){return"undefined"!=typeof(new Image).crossOrigin},b.exports=d},{}],30:[function(a,b,c){function d(a){this.src=a,this.image=document.createElement("canvas");var b=this;this.getBounds=function(a){return a.x1=a.x1+this.bb.x1,a.x2=a.x2+this.bb.width,a.y1=a.y1+this.bb.y1,a.y2=a.y2+this.bb.height,a},this.promise=(b.isInline(a)?e.resolve(b.inlineFormatting(a)):f(a)).then(function(a){return new e(function(b){h.parse(this.image,a,{renderCallback:function(a){this.bb=a.bounds,b()}.bind(this)})}.bind(this))}.bind(this))}var e=a("../promise"),f=a("../xhr"),g=a("../utils").decode64,h=a("./SVGParser.js");d.prototype.inlineFormatting=function(a){return/^data:image\/svg\+xml;base64,/.test(a)?this.decode64(this.removeContentType(a)):this.removeContentType(a)},d.prototype.removeContentType=function(a){return a.replace(/^data:image\/svg\+xml(;base64)?,/,"")},d.prototype.isInline=function(a){return/^data:image\/svg\+xml/i.test(a)},d.prototype.decode64=function(a){return"function"==typeof window.atob?window.atob(a):g(a)},b.exports=d},{"../promise":22,"../utils":34,"../xhr":35,"./SVGParser.js":32}],31:[function(a,b,c){function d(a){this.src=a,this.image=document.createElement("canvas"),this.bb=null;this.getBounds=function(a){return a.x1=a.x1+this.bb.x1,a.x2=a.x1+this.bb.width,a.y1=a.y1+this.bb.y1,a.y2=a.y1+this.bb.height,a}.bind(this),this.promise=new f(function(b,c){g.parse(this.image,a,{renderCallback:function(a){this.bb=a.bounds,b()}.bind(this)})}.bind(this))}var e=a("./SVGContainer"),f=a("../promise"),g=a("./SVGParser.js");a("../utils");d.prototype=Object.create(e.prototype),b.exports=d},{"../promise":22,"../utils":34,"./SVGContainer":30,"./SVGParser.js":32}],32:[function(a,b,c){function d(a){var b=[0,0,0],c=function(c,d){var e=a.match(c);null!=e&&(b[d]+=e.length,a=a.replace(c," "))};return a=a.replace(/:not\(([^\)]*)\)/g,"     $1 "),a=a.replace(/{[^]*/gm," "),c(l,1),c(m,0),c(n,1),c(o,2),c(p,1),c(q,1),a=a.replace(/[\*\s\+>~]/g," "),a=a.replace(/[#\.]/g," "),c(r,2),b.join("")}function e(a){var c={opts:a};c.FRAMERATE=30,c.MAX_VIRTUAL_PIXELS=3e4,c.log=g,c.init=function(a){var b=0;c.UniqueId=function(){return b++,"canvg"+b},c.Definitions={},c.Styles={},c.StylesSpecificity={},c.Animations=[],c.Images=[],c.ctx=a,c.ViewPort=new function(){this.viewPorts=[],this.Clear=function(){this.viewPorts=[]},this.SetCurrent=function(a,b){this.viewPorts.push({width:a,height:b})},this.RemoveCurrent=function(){this.viewPorts.pop()},this.Current=function(){return this.viewPorts[this.viewPorts.length-1]},this.width=function(){return this.Current().width},this.height=function(){return this.Current().height},this.ComputeSize=function(a){return null!=a&&"number"==typeof a?a:"x"==a?this.width():"y"==a?this.height():Math.sqrt(Math.pow(this.width(),2)+Math.pow(this.height(),2))/Math.sqrt(2)}}},c.init(),c.ImagesLoaded=function(){for(var a=0;a<c.Images.length;a++)if(!c.Images[a].loaded)return!1;return!0},c.trim=function(a){return a.replace(/^\s+|\s+$/g,"")},c.compressSpaces=function(a){return a.replace(/[\s\r\t\n]+/gm," ")},c.parseXml=function(a){if("undefined"!=typeof Windows&&"undefined"!=typeof Windows.Data&&"undefined"!=typeof Windows.Data.Xml){var b=new Windows.Data.Xml.Dom.XmlDocument,c=new Windows.Data.Xml.Dom.XmlLoadSettings;return c.prohibitDtd=!1,b.loadXml(a,c),b}if(window.DOMParser){var d=new DOMParser;return d.parseFromString(a,"text/xml")}a=a.replace(/<!DOCTYPE svg[^>]*>/,"");var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b},c.Property=function(a,b){this.name=a,this.value=b},c.Property.prototype.getValue=function(){return this.value},c.Property.prototype.hasValue=function(){return null!=this.value&&""!==this.value},c.Property.prototype.numValue=function(){if(!this.hasValue())return 0;var a=parseFloat(this.value);return(this.value+"").match(/%$/)&&(a/=100),a},c.Property.prototype.valueOrDefault=function(a){return this.hasValue()?this.value:a},c.Property.prototype.numValueOrDefault=function(a){return this.hasValue()?this.numValue():a},c.Property.prototype.addOpacity=function(a){var b=this.value;if(null!=a.value&&""!=a.value&&"string"==typeof this.value){var d=new f(this.value);null===d.a&&(d.a=a.numValue()),d.isColor&&(b=d.toString())}return new c.Property(this.name,b)},c.Property.prototype.getDefinition=function(){var a=this.value.match(/#([^\)'"]+)/);return a&&(a=a[1]),a||(a=this.value),c.Definitions[a]},c.Property.prototype.isUrlDefinition=function(){return 0==this.value.indexOf("url(")},c.Property.prototype.getFillStyleDefinition=function(a,b){var d=this.getDefinition();if(null!=d&&d.createGradient)return d.createGradient(c.ctx,a,b);if(null!=d&&d.createPattern){if(d.getHrefAttribute().hasValue()){var e=d.attribute("patternTransform");d=d.getHrefAttribute().getDefinition(),e.hasValue()&&(d.attribute("patternTransform",!0).value=e.value)}return d.createPattern(c.ctx,a)}return null},c.Property.prototype.getDPI=function(a){return 96},c.Property.prototype.getEM=function(a){var b=12,d=new c.Property("fontSize",c.Font.Parse(c.ctx.font).fontSize);return d.hasValue()&&(b=d.toPixels(a)),b},c.Property.prototype.getUnits=function(){var a=this.value+"";return a.replace(/[0-9\.\-]/g,"")},c.Property.prototype.toPixels=function(a,b){if(!this.hasValue())return 0;var d=this.value+"";if(d.match(/em$/))return this.numValue()*this.getEM(a);if(d.match(/ex$/))return this.numValue()*this.getEM(a)/2;if(d.match(/px$/))return this.numValue();if(d.match(/pt$/))return this.numValue()*this.getDPI(a)*(1/72);if(d.match(/pc$/))return 15*this.numValue();if(d.match(/cm$/))return this.numValue()*this.getDPI(a)/2.54;if(d.match(/mm$/))return this.numValue()*this.getDPI(a)/25.4;if(d.match(/in$/))return this.numValue()*this.getDPI(a);if(d.match(/%$/))return this.numValue()*c.ViewPort.ComputeSize(a);var e=this.numValue();return b&&1>e?e*c.ViewPort.ComputeSize(a):e},c.Property.prototype.toMilliseconds=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/s$/)?1e3*this.numValue():a.match(/ms$/)?this.numValue():this.numValue()},c.Property.prototype.toRadians=function(){if(!this.hasValue())return 0;var a=this.value+"";return a.match(/deg$/)?this.numValue()*(Math.PI/180):a.match(/grad$/)?this.numValue()*(Math.PI/200):a.match(/rad$/)?this.numValue():this.numValue()*(Math.PI/180)};var e={baseline:"alphabetic","before-edge":"top","text-before-edge":"top",middle:"middle",central:"middle","after-edge":"bottom","text-after-edge":"bottom",ideographic:"ideographic",alphabetic:"alphabetic",hanging:"hanging",mathematical:"alphabetic"};return c.Property.prototype.toTextBaseline=function(){return this.hasValue()?e[this.value]:null},c.Font=new function(){this.Styles="normal|italic|oblique|inherit",this.Variants="normal|small-caps|inherit",this.Weights="normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit",this.CreateFont=function(a,b,d,e,f,g){var h=null!=g?this.Parse(g):this.CreateFont("","","","","",c.ctx.font);return{fontFamily:f||h.fontFamily,fontSize:e||h.fontSize,fontStyle:a||h.fontStyle,fontWeight:d||h.fontWeight,fontVariant:b||h.fontVariant,toString:function(){return[this.fontStyle,this.fontVariant,this.fontWeight,this.fontSize,this.fontFamily].join(" ")}}};var a=this;this.Parse=function(b){for(var d={},e=c.trim(c.compressSpaces(b||"")).split(" "),f={fontSize:!1,fontStyle:!1,fontWeight:!1,fontVariant:!1},g="",h=0;h<e.length;h++)f.fontStyle||-1==a.Styles.indexOf(e[h])?f.fontVariant||-1==a.Variants.indexOf(e[h])?f.fontWeight||-1==a.Weights.indexOf(e[h])?f.fontSize?"inherit"!=e[h]&&(g+=e[h]):("inherit"!=e[h]&&(d.fontSize=e[h].split("/")[0]),f.fontStyle=f.fontVariant=f.fontWeight=f.fontSize=!0):("inherit"!=e[h]&&(d.fontWeight=e[h]),f.fontStyle=f.fontVariant=f.fontWeight=!0):("inherit"!=e[h]&&(d.fontVariant=e[h]),f.fontStyle=f.fontVariant=!0):("inherit"!=e[h]&&(d.fontStyle=e[h]),f.fontStyle=!0);return""!=g&&(d.fontFamily=g),d}},c.ToNumberArray=function(a){for(var b=c.trim(c.compressSpaces((a||"").replace(/,/g," "))).split(" "),d=0;d<b.length;d++)b[d]=parseFloat(b[d]);return b},c.Point=function(a,b){this.x=a,this.y=b},c.Point.prototype.angleTo=function(a){return Math.atan2(a.y-this.y,a.x-this.x)},c.Point.prototype.applyTransform=function(a){var b=this.x*a[0]+this.y*a[2]+a[4],c=this.x*a[1]+this.y*a[3]+a[5];this.x=b,this.y=c},c.CreatePoint=function(a){var b=c.ToNumberArray(a);return new c.Point(b[0],b[1])},c.CreatePath=function(a){for(var b=c.ToNumberArray(a),d=[],e=0;e<b.length;e+=2)d.push(new c.Point(b[e],b[e+1]));return d},c.BoundingBox=function(a,b,c,d){j.call(this,a,b,c,d),this.addX=function(a){this.addPoint(a,null)},this.addY=function(a){this.addPoint(null,a)},this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1),this.addPoint(a.x2,a.y2)},this.addQuadraticCurve=function(a,b,c,d,e,f){var g=a+2/3*(c-a),h=b+2/3*(d-b),i=g+1/3*(e-a),j=h+1/3*(f-b);this.addBezierCurve(a,b,g,i,h,j,e,f)},this.addBezierCurve=function(a,b,c,d,e,f,g,h){var j=[a,b],k=[c,d],l=[e,f],m=[g,h];for(this.addPoint(j[0],j[1]),this.addPoint(m[0],m[1]),i=0;i<=1;i++){var n=function(a){return Math.pow(1-a,3)*j[i]+3*Math.pow(1-a,2)*a*k[i]+3*(1-a)*Math.pow(a,2)*l[i]+Math.pow(a,3)*m[i]},o=6*j[i]-12*k[i]+6*l[i],p=-3*j[i]+9*k[i]-9*l[i]+3*m[i],q=3*k[i]-3*j[i];if(0!=p){var r=Math.pow(o,2)-4*q*p;if(!(0>r)){var s=(-o+Math.sqrt(r))/(2*p);s>0&&1>s&&(0==i&&this.addX(n(s)),1==i&&this.addY(n(s)));var t=(-o-Math.sqrt(r))/(2*p);t>0&&1>t&&(0==i&&this.addX(n(t)),1==i&&this.addY(n(t)))}}else{if(0==o)continue;var u=-q/o;u>0&&1>u&&(0==i&&this.addX(n(u)),1==i&&this.addY(n(u)))}}},this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2}},c.BoundingBox.prototype=Object.create(j.prototype),c.CanvasBoundingBox=new c.BoundingBox(0,0,0,0),c.CanvasBoundingBox.expand=function(a){if(this.freeze)return!1;if(a.x1<-500)throw new Error(a);var b=!1;return a.x1<this.x1&&(this.x1=a.x1,b=!0),a.x2>this.x2&&(this.x2=a.x2,b=!0),a.y1<this.y1&&(this.y1=a.y1,b=!0),a.y2>this.y2&&(this.y2=a.y2,b=!0),"undefined"==typeof this.overflow?!1:b},c.CanvasBoundingBox.apply=function(a,b){Math.floor(b.width)!==Math.floor(this.width)&&(a.canvas.width=this.width,a.canvas.style.width=a.canvas.width+"px"),Math.floor(b.height)!==Math.floor(this.height)&&(a.canvas.height=this.height,a.canvas.style.height=a.canvas.height+"px"),(0!==this.x1||0!==this.y1)&&(a.translate(-this.x1,-this.y1),a.translate(b.x1,b.y1))},c.Transform=function(a){var b=this;this.Type={},this.Type.translate=function(a){this.p=c.CreatePoint(a),this.apply=function(a){a.translate(this.p.x||0,this.p.y||0)},this.unapply=function(a){a.translate(-1*this.p.x||0,-1*this.p.y||0)},this.applyToPoint=function(a){a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0])}},this.Type.rotate=function(a){var b=c.ToNumberArray(a);this.angle=new c.Property("angle",b[0]),this.cx=b[1]||0,this.cy=b[2]||0,this.apply=function(a){a.translate(this.cx,this.cy);var b=this.angle.toRadians();a.transform(Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0),a.translate(-this.cx,-this.cy)},this.unapply=function(a){a.translate(this.cx,this.cy),a.rotate(-1*this.angle.toRadians()),a.translate(-this.cx,-this.cy)},this.applyToPoint=function(a){var b=this.angle.toRadians();a.applyTransform([1,0,0,1,this.p.x||0,this.p.y||0]),a.applyTransform([Math.cos(b),Math.sin(b),-Math.sin(b),Math.cos(b),0,0]),a.applyTransform([1,0,0,1,-this.p.x||0,-this.p.y||0])}},this.Type.scale=function(a){this.p=c.CreatePoint(a),this.apply=function(a){a.scale(this.p.x||1,this.p.y||this.p.x||1)},this.unapply=function(a){a.scale(1/this.p.x||1,1/this.p.y||this.p.x||1)},this.applyToPoint=function(a){a.applyTransform([this.p.x||0,0,0,this.p.y||0,0,0])}},this.Type.matrix=function(a){this.m=c.ToNumberArray(a),this.apply=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},this.unapply=function(a){var b=this.m[0],c=this.m[2],d=this.m[4],e=this.m[1],f=this.m[3],g=this.m[5],h=0,i=0,j=1,k=1/(b*(f*j-g*i)-c*(e*j-g*h)+d*(e*i-f*h));a.transform(k*(f*j-g*i),k*(g*h-e*j),k*(d*i-c*j),k*(b*j-d*h),k*(c*g-d*f),k*(d*e-b*g))},this.applyToPoint=function(a){a.applyTransform(this.m)}},this.Type.SkewBase=function(a){this.base=b.Type.matrix,this.base(a),this.angle=new c.Property("angle",a)},this.Type.SkewBase.prototype=new this.Type.matrix,this.Type.skewX=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,0,Math.tan(this.angle.toRadians()),1,0,0]},this.Type.skewX.prototype=new this.Type.SkewBase,this.Type.skewY=function(a){this.base=b.Type.SkewBase,this.base(a),this.m=[1,Math.tan(this.angle.toRadians()),0,1,0,0]},this.Type.skewY.prototype=new this.Type.SkewBase,this.transforms=[],this.apply=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].apply(a)},this.unapply=function(a){for(var b=this.transforms.length-1;b>=0;b--)this.transforms[b].unapply(a)},this.applyToPoint=function(a){for(var b=0;b<this.transforms.length;b++)this.transforms[b].applyToPoint(a)};for(var d=c.trim(c.compressSpaces(a)).replace(/\)([a-zA-Z])/g,") $1").replace(/\)(\s?,\s?)/g,") ").split(/\s(?=[a-z])/),e=0;e<d.length;e++){var f=c.trim(d[e].split("(")[0]),g=d[e].split("(")[1].replace(")",""),h=new this.Type[f](g);h.type=f,this.transforms.push(h)}},c.AspectRatio=function(a,b,d,e,f,g,h,i,j,k){b=c.compressSpaces(b),b=b.replace(/^defer\s/,"");var l=b.split(" ")[0]||"xMidYMid",m=b.split(" ")[1]||"meet",n=d/e,o=f/g,p=Math.min(n,o),q=Math.max(n,o);"meet"==m&&(e*=p,g*=p),"slice"==m&&(e*=q,g*=q),j=new c.Property("refX",j),k=new c.Property("refY",k),j.hasValue()&&k.hasValue()?a.translate(-p*j.toPixels("x"),-p*k.toPixels("y")):(l.match(/^xMid/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(d/2-e/2,0),l.match(/YMid$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,f/2-g/2),l.match(/^xMax/)&&("meet"==m&&p==o||"slice"==m&&q==o)&&a.translate(d-e,0),l.match(/YMax$/)&&("meet"==m&&p==n||"slice"==m&&q==n)&&a.translate(0,f-g)),"none"==l?a.scale(n,o):"meet"==m?a.scale(p,p):"slice"==m&&a.scale(q,q),a.translate(null==h?0:-h,null==i?0:-i)},c.Element={},c.EmptyProperty=new c.Property("EMPTY",""),c.Element.ElementBase=function(a){if(this.attributes={},this.styles={},this.stylesSpecificity={},this.children=[],this.attribute=function(a,b){var d=this.attributes[a];return null!=d?d:(1==b&&(d=new c.Property(a,""),this.attributes[a]=d),d||c.EmptyProperty)},this.getHrefAttribute=function(){for(var a in this.attributes)if(a.match(/:href$/))return this.attributes[a];return c.EmptyProperty},this.style=function(a,b,d){var e=this.styles[a];if(null!=e)return e;var f=this.attribute(a);if(null!=f&&f.hasValue())return this.styles[a]=f,f;if(1!=d){var g=this.parent;if(null!=g){var h=g.style(a);if(null!=h&&h.hasValue())return h}}return 1==b&&(e=new c.Property(a,""),this.styles[a]=e),e||c.EmptyProperty},this.render=function(a){if("none"!=this.style("display").value&&"hidden"!=this.style("visibility").value){if(a.save(),this.attribute("mask").hasValue()){var b=this.attribute("mask").getDefinition();null!=b&&b.apply(a,this)}else if(this.style("filter").hasValue()){var c=this.style("filter").getDefinition();null!=c&&c.apply(a,this)}else this.setContext(a),this.renderChildren(a),this.clearContext(a);a.restore()}},this.setContext=function(a){},this.clearContext=function(a){},this.renderChildren=function(a){for(var b=0;b<this.children.length;b++)this.children[b].render(a)},this.addChild=function(a,b){var d=a;b&&(d=c.CreateElement(a)),d.parent=this,"title"!=d.type&&this.children.push(d)},this.addStylesFromStyleDefinition=function(){for(var b in c.Styles)if(k(a,b)){var d=c.Styles[b],e=c.StylesSpecificity[b];if(null!=d)for(var f in d){var g=this.stylesSpecificity[f];"undefined"==typeof g&&(g="000"),e>g&&(this.styles[f]=d[f],this.stylesSpecificity[f]=e)}}},null!=a&&1==a.nodeType){for(var b=0;b<a.attributes.length;b++){var d=a.attributes[b];this.attributes[d.nodeName]=new c.Property(d.nodeName,d.value)}if(this.addStylesFromStyleDefinition(),this.attribute("style").hasValue())for(var e=this.attribute("style").value.split(";"),b=0;b<e.length;b++)if(""!=c.trim(e[b])){var f=e[b].split(":"),g=c.trim(f[0]),h=c.trim(f[1]);this.styles[g]=new c.Property(g,h)}this.attribute("id").hasValue()&&null==c.Definitions[this.attribute("id").value]&&(c.Definitions[this.attribute("id").value]=this);for(var b=0;b<a.childNodes.length;b++){var i=a.childNodes[b];if(1==i.nodeType&&this.addChild(i,!0),this.captureTextNodes&&(3==i.nodeType||4==i.nodeType)){var j=i.value||i.text||i.textContent||"";""!=c.compressSpaces(j)&&this.addChild(new c.Element.tspan(i),!1)}}}},c.Element.RenderedElementBase=function(a){this.base=c.Element.ElementBase,this.base(a),this.setContext=function(a){if(this.style("fill").isUrlDefinition()){var b=this.style("fill").getFillStyleDefinition(this,this.style("fill-opacity"));null!=b&&(a.fillStyle=b)}else if(this.style("fill").hasValue()){var d=this.style("fill");"currentColor"==d.value&&(d.value=this.style("color").value),"inherit"!=d.value&&(a.fillStyle="none"==d.value?"rgba(0,0,0,0)":d.value)}if(this.style("fill-opacity").hasValue()){var d=new c.Property("fill",a.fillStyle);d=d.addOpacity(this.style("fill-opacity")),a.fillStyle=d.value}if(this.style("stroke").isUrlDefinition()){var b=this.style("stroke").getFillStyleDefinition(this,this.style("stroke-opacity"));null!=b&&(a.strokeStyle=b)}else if(this.style("stroke").hasValue()){var e=this.style("stroke");"currentColor"==e.value&&(e.value=this.style("color").value),"inherit"!=e.value&&(a.strokeStyle="none"==e.value?"rgba(0,0,0,0)":e.value)}if(this.style("stroke-opacity").hasValue()){var e=new c.Property("stroke",a.strokeStyle);e=e.addOpacity(this.style("stroke-opacity")),a.strokeStyle=e.value}if(this.style("stroke-width").hasValue()){var f=this.style("stroke-width").toPixels();a.lineWidth=0==f?.001:f}if(this.style("stroke-linecap").hasValue()&&(a.lineCap=this.style("stroke-linecap").value),this.style("stroke-linejoin").hasValue()&&(a.lineJoin=this.style("stroke-linejoin").value),this.style("stroke-miterlimit").hasValue()&&(a.miterLimit=this.style("stroke-miterlimit").value),this.style("stroke-dasharray").hasValue()&&"none"!=this.style("stroke-dasharray").value){var g=c.ToNumberArray(this.style("stroke-dasharray").value);"undefined"!=typeof a.setLineDash?a.setLineDash(g):"undefined"!=typeof a.webkitLineDash?a.webkitLineDash=g:"undefined"==typeof a.mozDash||1==g.length&&0==g[0]||(a.mozDash=g);var h=this.style("stroke-dashoffset").numValueOrDefault(1);"undefined"!=typeof a.lineDashOffset?a.lineDashOffset=h:"undefined"!=typeof a.webkitLineDashOffset?a.webkitLineDashOffset=h:"undefined"!=typeof a.mozDashOffset&&(a.mozDashOffset=h)}if("undefined"!=typeof a.font&&(a.font=c.Font.CreateFont(this.style("font-style").value,this.style("font-variant").value,this.style("font-weight").value,this.style("font-size").hasValue()?this.style("font-size").toPixels()+"px":"",this.style("font-family").value).toString()),this.attribute("transform").hasValue()){var i=new c.Transform(this.attribute("transform").value);i.apply(a)}if(this.attribute("clip-path",!1,!0).hasValue()){var j=this.attribute("clip-path",!1,!0).getDefinition();null!=j&&j.apply(a)}this.style("opacity").hasValue()&&(a.globalAlpha=this.style("opacity").numValue())}},c.Element.RenderedElementBase.prototype=new c.Element.ElementBase,c.Element.PathElementBase=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.path=function(a){return null!=a&&a.beginPath(),new c.BoundingBox},this.baseSetContext=this.setContext,this.setContext=function(a){var b=this.getBoundingBox(),d={width:c.CanvasBoundingBox.width,height:c.CanvasBoundingBox.height,x1:c.CanvasBoundingBox.x1,y1:c.CanvasBoundingBox.y1};c.CanvasBoundingBox.expand(b)&&c.CanvasBoundingBox.apply(a,d),this.baseSetContext(a)},this.renderChildren=function(a){this.path(a),c.Mouse.checkPath(this,a),""!=a.fillStyle&&("inherit"!=this.style("fill-rule").valueOrDefault("inherit")?a.fill(this.style("fill-rule").value):a.fill()),""!=a.strokeStyle&&a.stroke();var b=this.getMarkers();if(null!=b){if(this.style("marker-start").isUrlDefinition()){var d=this.style("marker-start").getDefinition();d.render(a,b[0][0],b[0][1])}if(this.style("marker-mid").isUrlDefinition())for(var d=this.style("marker-mid").getDefinition(),e=1;e<b.length-1;e++)d.render(a,b[e][0],b[e][1]);if(this.style("marker-end").isUrlDefinition()){var d=this.style("marker-end").getDefinition();d.render(a,b[b.length-1][0],b[b.length-1][1])}}},this.getBoundingBox=function(){if(null!=a&&"undefined"!=typeof a.getBBox){var b=a.getBBox();return new c.BoundingBox(b.x,b.y,b.x+b.width,b.y+b.height)}return this.path()},this.getMarkers=function(){return null}},c.Element.PathElementBase.prototype=new c.Element.RenderedElementBase,c.Element.svg=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.baseClearContext=this.clearContext,this.clearContext=function(a){this.baseClearContext(a),c.ViewPort.RemoveCurrent()},this.baseSetContext=this.setContext,this.setContext=function(a){a.strokeStyle="rgba(0,0,0,0)",a.lineCap="butt",a.lineJoin="miter",a.miterLimit=4,"undefined"!=typeof a.font&&"undefined"!=typeof window.getComputedStyle&&(a.font=window.getComputedStyle(a.canvas).getPropertyValue("font")),this.baseSetContext(a),this.attribute("x").hasValue()||(this.attribute("x",!0).value=0),this.attribute("y").hasValue()||(this.attribute("y",!0).value=0),a.translate(this.attribute("x").toPixels("x"),this.attribute("y").toPixels("y"));var b=c.ViewPort.width(),d=c.ViewPort.height();if(this.attribute("width").hasValue()||(this.attribute("width",!0).value="100%"),this.attribute("height").hasValue()||(this.attribute("height",!0).value="100%"),"undefined"==typeof this.root){b=this.attribute("width").toPixels("x"),d=this.attribute("height").toPixels("y");var e=0,f=0;this.attribute("refX").hasValue()&&this.attribute("refY").hasValue()&&(e=-this.attribute("refX").toPixels("x"),f=-this.attribute("refY").toPixels("y"))}if(c.ViewPort.SetCurrent(b,d),this.attribute("viewBox").hasValue()){var g=c.ToNumberArray(this.attribute("viewBox").value),h=g[0],i=g[1];b=g[2],d=g[3],c.AspectRatio(a,this.attribute("preserveAspectRatio").value,c.ViewPort.width(),b,c.ViewPort.height(),d,h,i,this.attribute("refX").value,this.attribute("refY").value),c.ViewPort.RemoveCurrent(),c.ViewPort.SetCurrent(g[2],g[3])}this.styles.overflow&&"visible"===this.styles.overflow.value&&(c.CanvasBoundingBox.overflow=!0),c.CanvasBoundingBox.expand(new c.BoundingBox(0,0,c.ViewPort.width(),c.ViewPort.height()))}},c.Element.svg.prototype=new c.Element.RenderedElementBase,c.Element.rect=function(a){this.base=c.Element.PathElementBase,this.base(a),this.path=function(a){var b=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),e=this.attribute("width").toPixels("x"),f=this.attribute("height").toPixels("y"),g=this.attribute("rx").toPixels("x"),h=this.attribute("ry").toPixels("y");return this.attribute("rx").hasValue()&&!this.attribute("ry").hasValue()&&(h=g),this.attribute("ry").hasValue()&&!this.attribute("rx").hasValue()&&(g=h),g=Math.min(g,e/2),h=Math.min(h,f/2),null!=a&&(a.beginPath(),a.moveTo(b+g,d),a.lineTo(b+e-g,d),a.quadraticCurveTo(b+e,d,b+e,d+h),a.lineTo(b+e,d+f-h),a.quadraticCurveTo(b+e,d+f,b+e-g,d+f),a.lineTo(b+g,d+f),a.quadraticCurveTo(b,d+f,b,d+f-h),a.lineTo(b,d+h),a.quadraticCurveTo(b,d,b+g,d),a.closePath()),new c.BoundingBox(b,d,b+e,d+f)}},c.Element.rect.prototype=new c.Element.PathElementBase,c.Element.circle=function(a){this.base=c.Element.PathElementBase,this.base(a),this.path=function(a){
var b=this.attribute("cx").toPixels("x"),d=this.attribute("cy").toPixels("y"),e=this.attribute("r").toPixels();return null!=a&&(a.beginPath(),a.arc(b,d,e,0,2*Math.PI,!0),a.closePath()),new c.BoundingBox(b-e,d-e,b+e,d+e)}},c.Element.circle.prototype=new c.Element.PathElementBase,c.Element.ellipse=function(a){this.base=c.Element.PathElementBase,this.base(a),this.path=function(a){var b=4*((Math.sqrt(2)-1)/3),d=this.attribute("rx").toPixels("x"),e=this.attribute("ry").toPixels("y"),f=this.attribute("cx").toPixels("x"),g=this.attribute("cy").toPixels("y");return null!=a&&(a.beginPath(),a.moveTo(f,g-e),a.bezierCurveTo(f+b*d,g-e,f+d,g-b*e,f+d,g),a.bezierCurveTo(f+d,g+b*e,f+b*d,g+e,f,g+e),a.bezierCurveTo(f-b*d,g+e,f-d,g+b*e,f-d,g),a.bezierCurveTo(f-d,g-b*e,f-b*d,g-e,f,g-e),a.closePath()),new c.BoundingBox(f-d,g-e,f+d,g+e)}},c.Element.ellipse.prototype=new c.Element.PathElementBase,c.Element.line=function(a){this.base=c.Element.PathElementBase,this.base(a),this.getPoints=function(){return[new c.Point(this.attribute("x1").toPixels("x"),this.attribute("y1").toPixels("y")),new c.Point(this.attribute("x2").toPixels("x"),this.attribute("y2").toPixels("y"))]},this.path=function(a){var b=this.getPoints();return null!=a&&(a.beginPath(),a.moveTo(b[0].x,b[0].y),a.lineTo(b[1].x,b[1].y)),new c.BoundingBox(b[0].x,b[0].y,b[1].x,b[1].y)},this.getMarkers=function(){var a=this.getPoints(),b=a[0].angleTo(a[1]);return[[a[0],b],[a[1],b]]}},c.Element.line.prototype=new c.Element.PathElementBase,c.Element.polyline=function(a){this.base=c.Element.PathElementBase,this.base(a),this.points=c.CreatePath(this.attribute("points").value),this.path=function(a){var b=new c.BoundingBox(this.points[0].x,this.points[0].y);null!=a&&(a.beginPath(),a.moveTo(this.points[0].x,this.points[0].y));for(var d=1;d<this.points.length;d++)b.addPoint(this.points[d].x,this.points[d].y),null!=a&&a.lineTo(this.points[d].x,this.points[d].y);return b},this.getMarkers=function(){for(var a=[],b=0;b<this.points.length-1;b++)a.push([this.points[b],this.points[b].angleTo(this.points[b+1])]);return a.push([this.points[this.points.length-1],a[a.length-1][1]]),a}},c.Element.polyline.prototype=new c.Element.PathElementBase,c.Element.polygon=function(a){this.base=c.Element.polyline,this.base(a),this.basePath=this.path,this.path=function(a){var b=this.basePath(a);return null!=a&&(a.lineTo(this.points[0].x,this.points[0].y),a.closePath()),b}},c.Element.polygon.prototype=new c.Element.polyline,c.Element.path=function(a){this.base=c.Element.PathElementBase,this.base(a);var b=this.attribute("d").value;b=b.replace(/,/gm," ");for(var d=0;2>d;d++)b=b.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");b=b.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2"),b=b.replace(/([0-9])([+\-])/gm,"$1 $2");for(var d=0;2>d;d++)b=b.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");b=b.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 "),b=c.compressSpaces(b),b=c.trim(b),this.PathParser=new function(a){this.tokens=a.split(" "),this.reset=function(){this.i=-1,this.command="",this.previousCommand="",this.start=new c.Point(0,0),this.control=new c.Point(0,0),this.current=new c.Point(0,0),this.points=[],this.angles=[]},this.isEnd=function(){return this.i>=this.tokens.length-1},this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.i+1].match(/^[A-Za-z]$/)},this.isRelativeCommand=function(){switch(this.command){case"m":case"l":case"h":case"v":case"c":case"s":case"q":case"t":case"a":case"z":return!0}return!1},this.getToken=function(){return this.i++,this.tokens[this.i]},this.getScalar=function(){return parseFloat(this.getToken())},this.nextCommand=function(){this.previousCommand=this.command,this.command=this.getToken()},this.getPoint=function(){var a=new c.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)},this.getAsControlPoint=function(){var a=this.getPoint();return this.control=a,a},this.getAsCurrentPoint=function(){var a=this.getPoint();return this.current=a,a},this.getReflectedControlPoint=function(){if("c"!=this.previousCommand.toLowerCase()&&"s"!=this.previousCommand.toLowerCase()&&"q"!=this.previousCommand.toLowerCase()&&"t"!=this.previousCommand.toLowerCase())return this.current;var a=new c.Point(2*this.current.x-this.control.x,2*this.current.y-this.control.y);return a},this.makeAbsolute=function(a){return this.isRelativeCommand()&&(a.x+=this.current.x,a.y+=this.current.y),a},this.addMarker=function(a,b,c){null!=c&&this.angles.length>0&&null==this.angles[this.angles.length-1]&&(this.angles[this.angles.length-1]=this.points[this.points.length-1].angleTo(c)),this.addMarkerAngle(a,null==b?null:b.angleTo(a))},this.addMarkerAngle=function(a,b){this.points.push(a),this.angles.push(b)},this.getMarkerPoints=function(){return this.points},this.getMarkerAngles=function(){for(var a=0;a<this.angles.length;a++)if(null==this.angles[a])for(var b=a+1;b<this.angles.length;b++)if(null!=this.angles[b]){this.angles[a]=this.angles[b];break}return this.angles}}(b),this.path=function(a){var b=this.PathParser;b.reset();var d=new c.BoundingBox;for(null!=a&&a.beginPath();!b.isEnd();)switch(b.nextCommand(),b.command){case"M":case"m":var e=b.getAsCurrentPoint();for(b.addMarker(e),d.addPoint(e.x,e.y),null!=a&&a.moveTo(e.x,e.y),b.start=b.current;!b.isCommandOrEnd();){var e=b.getAsCurrentPoint();b.addMarker(e,b.start),d.addPoint(e.x,e.y),null!=a&&a.lineTo(e.x,e.y)}break;case"L":case"l":for(;!b.isCommandOrEnd();){var f=b.current,e=b.getAsCurrentPoint();b.addMarker(e,f),d.addPoint(e.x,e.y),null!=a&&a.lineTo(e.x,e.y)}break;case"H":case"h":for(;!b.isCommandOrEnd();){var g=new c.Point((b.isRelativeCommand()?b.current.x:0)+b.getScalar(),b.current.y);b.addMarker(g,b.current),b.current=g,d.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"V":case"v":for(;!b.isCommandOrEnd();){var g=new c.Point(b.current.x,(b.isRelativeCommand()?b.current.y:0)+b.getScalar());b.addMarker(g,b.current),b.current=g,d.addPoint(b.current.x,b.current.y),null!=a&&a.lineTo(b.current.x,b.current.y)}break;case"C":case"c":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"S":case"s":for(;!b.isCommandOrEnd();){var h=b.current,i=b.getReflectedControlPoint(),j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,i),d.addBezierCurve(h.x,h.y,i.x,i.y,j.x,j.y,k.x,k.y),null!=a&&a.bezierCurveTo(i.x,i.y,j.x,j.y,k.x,k.y)}break;case"Q":case"q":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getAsControlPoint(),k=b.getAsCurrentPoint();b.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"T":case"t":for(;!b.isCommandOrEnd();){var h=b.current,j=b.getReflectedControlPoint();b.control=j;var k=b.getAsCurrentPoint();b.addMarker(k,j,j),d.addQuadraticCurve(h.x,h.y,j.x,j.y,k.x,k.y),null!=a&&a.quadraticCurveTo(j.x,j.y,k.x,k.y)}break;case"A":case"a":for(;!b.isCommandOrEnd();){var h=b.current,l=b.getScalar(),m=b.getScalar(),n=b.getScalar()*(Math.PI/180),o=b.getScalar(),p=b.getScalar(),k=b.getAsCurrentPoint(),q=new c.Point(Math.cos(n)*(h.x-k.x)/2+Math.sin(n)*(h.y-k.y)/2,-Math.sin(n)*(h.x-k.x)/2+Math.cos(n)*(h.y-k.y)/2),r=Math.pow(q.x,2)/Math.pow(l,2)+Math.pow(q.y,2)/Math.pow(m,2);r>1&&(l*=Math.sqrt(r),m*=Math.sqrt(r));var s=(o==p?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(q.y,2)-Math.pow(m,2)*Math.pow(q.x,2))/(Math.pow(l,2)*Math.pow(q.y,2)+Math.pow(m,2)*Math.pow(q.x,2)));isNaN(s)&&(s=0);var t=new c.Point(s*l*q.y/m,s*-m*q.x/l),u=new c.Point((h.x+k.x)/2+Math.cos(n)*t.x-Math.sin(n)*t.y,(h.y+k.y)/2+Math.sin(n)*t.x+Math.cos(n)*t.y),v=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},w=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(v(a)*v(b))},x=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(w(a,b))},y=x([1,0],[(q.x-t.x)/l,(q.y-t.y)/m]),z=[(q.x-t.x)/l,(q.y-t.y)/m],A=[(-q.x-t.x)/l,(-q.y-t.y)/m],B=x(z,A);w(z,A)<=-1&&(B=Math.PI),w(z,A)>=1&&(B=0);var C=1-p?1:-1,D=y+C*(B/2),E=new c.Point(u.x+l*Math.cos(D),u.y+m*Math.sin(D));if(b.addMarkerAngle(E,D-C*Math.PI/2),b.addMarkerAngle(k,D-C*Math.PI),d.addPoint(k.x,k.y),null!=a){var w=l>m?l:m,F=l>m?1:l/m,G=l>m?m/l:1;a.translate(u.x,u.y),a.rotate(n),a.scale(F,G),a.arc(0,0,w,y,y+B,1-p),a.scale(1/F,1/G),a.rotate(-n),a.translate(-u.x,-u.y)}}break;case"Z":case"z":null!=a&&a.closePath(),b.current=b.start}return d},this.getMarkers=function(){for(var a=this.PathParser.getMarkerPoints(),b=this.PathParser.getMarkerAngles(),c=[],d=0;d<a.length;d++)c.push([a[d],b[d]]);return c}},c.Element.path.prototype=new c.Element.PathElementBase,c.Element.pattern=function(a){this.base=c.Element.ElementBase,this.base(a),this.createPattern=function(a,b){var d=this.attribute("width").toPixels("x",!0),e=this.attribute("height").toPixels("y",!0),f=new c.Element.svg;f.attributes.viewBox=new c.Property("viewBox",this.attribute("viewBox").value),f.attributes.width=new c.Property("width",d+"px"),f.attributes.height=new c.Property("height",e+"px"),f.attributes.transform=new c.Property("transform",this.attribute("patternTransform").value),f.children=this.children;var g=document.createElement("canvas");g.width=d,g.height=e;var h=g.getContext("2d");this.attribute("x").hasValue()&&this.attribute("y").hasValue()&&h.translate(this.attribute("x").toPixels("x",!0),this.attribute("y").toPixels("y",!0));for(var i=-1;1>=i;i++)for(var j=-1;1>=j;j++)h.save(),h.translate(i*g.width,j*g.height),c.CanvasBoundingBox.freeze=!0,f.render(h),c.CanvasBoundingBox.freeze=!1,h.restore();var k=a.createPattern(g,"repeat");return k}},c.Element.pattern.prototype=new c.Element.ElementBase,c.Element.marker=function(a){this.base=c.Element.ElementBase,this.base(a),this.baseRender=this.render,this.render=function(a,b,d){a.translate(b.x,b.y),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(d),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(a.lineWidth,a.lineWidth),a.save();var e=new c.Element.svg;e.attributes.viewBox=new c.Property("viewBox",this.attribute("viewBox").value),e.attributes.refX=new c.Property("refX",this.attribute("refX").value),e.attributes.refY=new c.Property("refY",this.attribute("refY").value),e.attributes.width=new c.Property("width",this.attribute("markerWidth").value),e.attributes.height=new c.Property("height",this.attribute("markerHeight").value),e.attributes.fill=new c.Property("fill",this.attribute("fill").valueOrDefault("black")),e.attributes.stroke=new c.Property("stroke",this.attribute("stroke").valueOrDefault("none")),e.children=this.children,e.render(a),a.restore(),"strokeWidth"==this.attribute("markerUnits").valueOrDefault("strokeWidth")&&a.scale(1/a.lineWidth,1/a.lineWidth),"auto"==this.attribute("orient").valueOrDefault("auto")&&a.rotate(-d),a.translate(-b.x,-b.y)}},c.Element.marker.prototype=new c.Element.ElementBase,c.Element.defs=function(a){this.base=c.Element.ElementBase,this.base(a),this.render=function(a){}},c.Element.defs.prototype=new c.Element.ElementBase,c.Element.GradientBase=function(a){this.base=c.Element.ElementBase,this.base(a),this.gradientUnits=this.attribute("gradientUnits").valueOrDefault("objectBoundingBox"),this.stops=[];for(var b=0;b<this.children.length;b++){var d=this.children[b];"stop"==d.type&&this.stops.push(d)}this.getGradient=function(){},this.createGradient=function(a,b,d){var e=this;this.getHrefAttribute().hasValue()&&(e=this.getHrefAttribute().getDefinition());var f=function(a){if(d.hasValue()){var b=new c.Property("color",a);return b.addOpacity(d).value}return a},g=this.getGradient(a,b);if(null==g)return f(e.stops[e.stops.length-1].color);for(var h=0;h<e.stops.length;h++)g.addColorStop(e.stops[h].offset,f(e.stops[h].color));if(this.attribute("gradientTransform").hasValue()){var i="objectBoundingBox"==this.gradientUnits?b.getBoundingBox():c.ViewPort.Current(),j=new c.Element.rect;j.attributes.x=new c.Property("x",-c.MAX_VIRTUAL_PIXELS/3),j.attributes.y=new c.Property("y",-c.MAX_VIRTUAL_PIXELS/3),j.attributes.width=new c.Property("width",c.MAX_VIRTUAL_PIXELS),j.attributes.height=new c.Property("height",c.MAX_VIRTUAL_PIXELS);var k=new c.Element.g;k.attributes.transform=new c.Property("transform",this.attribute("gradientTransform").value),k.children=[j];var l=new c.Element.svg;l.attributes.x=new c.Property("x",0),l.attributes.y=new c.Property("y",0),l.attributes.width=new c.Property("width",i.width),l.attributes.height=new c.Property("height",i.height),l.children=[k];var m=document.createElement("canvas");m.width=i.width,m.height=i.height;var n=m.getContext("2d");if(n.fillStyle=g,c.CanvasBoundingBox.freeze=!0,i.width!==i.height){var o=i.width>i.height?i.width/i.height:1,p=i.height>i.width?i.height/i.width:1;n.scale(o,p)}return b.style("stroke-width").hasValue()&&n.translate(-b.style("stroke-width").toPixels(),-b.style("stroke-width").toPixels()),n.translate(-i.x,-i.y),l.render(n),c.CanvasBoundingBox.freeze=!1,n.createPattern(m,"no-repeat")}return g}},c.Element.GradientBase.prototype=new c.Element.ElementBase,c.Element.linearGradient=function(a){this.base=c.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c="objectBoundingBox"==this.gradientUnits?b.getBoundingBox():null;this.attribute("x1").hasValue()||this.attribute("y1").hasValue()||this.attribute("x2").hasValue()||this.attribute("y2").hasValue()||(this.attribute("x1",!0).value=0,this.attribute("y1",!0).value=0,this.attribute("x2",!0).value=1,this.attribute("y2",!0).value=0);var d=Math.min(c.width,c.height),e="objectBoundingBox"==this.gradientUnits?c.x+d*this.attribute("x1").numValue():this.attribute("x1").toPixels("x"),f="objectBoundingBox"==this.gradientUnits?c.y+d*this.attribute("y1").numValue():this.attribute("y1").toPixels("y"),g="objectBoundingBox"==this.gradientUnits?c.x+d*this.attribute("x2").numValue():this.attribute("x2").toPixels("x"),h="objectBoundingBox"==this.gradientUnits?c.y+d*this.attribute("y2").numValue():this.attribute("y2").toPixels("y");return e==g&&f==h?null:a.createLinearGradient(e,f,g,h)}},c.Element.linearGradient.prototype=new c.Element.GradientBase,c.Element.radialGradient=function(a){this.base=c.Element.GradientBase,this.base(a),this.getGradient=function(a,b){var c=b.getBoundingBox();this.attribute("cx").hasValue()||(this.attribute("cx",!0).value="50%"),this.attribute("cy").hasValue()||(this.attribute("cy",!0).value="50%"),this.attribute("r").hasValue()||(this.attribute("r",!0).value="50%");var d="objectBoundingBox"==this.gradientUnits?c.x+c.width*this.attribute("cx").numValue():this.attribute("cx").toPixels("x"),e="objectBoundingBox"==this.gradientUnits?c.y+c.height*this.attribute("cy").numValue():this.attribute("cy").toPixels("y"),f=d,g=e;this.attribute("fx").hasValue()&&(f="objectBoundingBox"==this.gradientUnits?c.x+c.width*this.attribute("fx").numValue():this.attribute("fx").toPixels("x")),this.attribute("fy").hasValue()&&(g="objectBoundingBox"==this.gradientUnits?c.y+c.height*this.attribute("fy").numValue():this.attribute("fy").toPixels("y"));var h="objectBoundingBox"==this.gradientUnits?(c.width+c.height)/2*this.attribute("r").numValue():this.attribute("r").toPixels();return a.createRadialGradient(f,g,0,d,e,h)}},c.Element.radialGradient.prototype=new c.Element.GradientBase,c.Element.stop=function(a){this.base=c.Element.ElementBase,this.base(a),this.offset=this.attribute("offset").numValue(),this.offset<0&&(this.offset=0),this.offset>1&&(this.offset=1);var b=this.style("stop-color",!0);""===b.value&&(b.value="#000"),this.style("stop-opacity").hasValue()&&(b=b.addOpacity(this.style("stop-opacity"))),this.color=b.value},c.Element.stop.prototype=new c.Element.ElementBase,c.Element.AnimateBase=function(a){this.base=c.Element.ElementBase,this.base(a),c.Animations.push(this),this.duration=0,this.begin=this.attribute("begin").toMilliseconds(),this.maxDuration=this.begin+this.attribute("dur").toMilliseconds(),this.getProperty=function(){var a=this.attribute("attributeType").value,b=this.attribute("attributeName").value;return"CSS"==a?this.parent.style(b,!0):this.parent.attribute(b,!0)},this.initialValue=null,this.initialUnits="",this.removed=!1,this.calcValue=function(){return""},this.update=function(a){if(null==this.initialValue&&(this.initialValue=this.getProperty().value,this.initialUnits=this.getProperty().getUnits()),this.duration>this.maxDuration){if("indefinite"==this.attribute("repeatCount").value||"indefinite"==this.attribute("repeatDur").value)this.duration=0;else if("freeze"!=this.attribute("fill").valueOrDefault("remove")||this.frozen){if("remove"==this.attribute("fill").valueOrDefault("remove")&&!this.removed)return this.removed=!0,this.getProperty().value=this.parent.animationFrozen?this.parent.animationFrozenValue:this.initialValue,!0}else this.frozen=!0,this.parent.animationFrozen=!0,this.parent.animationFrozenValue=this.getProperty().value;return!1}this.duration=this.duration+a;var b=!1;if(this.begin<this.duration){var c=this.calcValue();if(this.attribute("type").hasValue()){var d=this.attribute("type").value;c=d+"("+c+")"}this.getProperty().value=c,b=!0}return b},this.from=this.attribute("from"),this.to=this.attribute("to"),this.values=this.attribute("values"),this.values.hasValue()&&(this.values.value=this.values.value.split(";")),this.progress=function(){var a={progress:(this.duration-this.begin)/(this.maxDuration-this.begin)};if(this.values.hasValue()){var b=a.progress*(this.values.value.length-1),d=Math.floor(b),e=Math.ceil(b);a.from=new c.Property("from",parseFloat(this.values.value[d])),a.to=new c.Property("to",parseFloat(this.values.value[e])),a.progress=(b-d)/(e-d)}else a.from=this.from,a.to=this.to;return a}},c.Element.AnimateBase.prototype=new c.Element.ElementBase,c.Element.animate=function(a){this.base=c.Element.AnimateBase,this.base(a),this.calcValue=function(){var a=this.progress(),b=a.from.numValue()+(a.to.numValue()-a.from.numValue())*a.progress;return b+this.initialUnits}},c.Element.animate.prototype=new c.Element.AnimateBase,c.Element.animateColor=function(a){this.base=c.Element.AnimateBase,this.base(a),this.calcValue=function(){var a=this.progress(),b=new f(a.from.value),c=new f(a.to.value);if(b.isColor&&c.isColor){var d=b.r+(c.r-b.r)*a.progress,e=b.g+(c.g-b.g)*a.progress,g=b.b+(c.b-b.b)*a.progress;return"rgb("+parseInt(d,10)+","+parseInt(e,10)+","+parseInt(g,10)+")"}return this.attribute("from").value}},c.Element.animateColor.prototype=new c.Element.AnimateBase,c.Element.animateTransform=function(a){this.base=c.Element.AnimateBase,this.base(a),this.calcValue=function(){for(var a=this.progress(),b=c.ToNumberArray(a.from.value),d=c.ToNumberArray(a.to.value),e="",f=0;f<b.length;f++)e+=b[f]+(d[f]-b[f])*a.progress+" ";return e}},c.Element.animateTransform.prototype=new c.Element.animate,c.Element.font=function(a){this.base=c.Element.ElementBase,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.isRTL=!1,this.isArabic=!1,this.fontFace=null,this.missingGlyph=null,this.glyphs=[];for(var b=0;b<this.children.length;b++){var d=this.children[b];"font-face"==d.type?(this.fontFace=d,d.style("font-family").hasValue()&&(c.Definitions[d.style("font-family").value]=this)):"missing-glyph"==d.type?this.missingGlyph=d:"glyph"==d.type&&(""!=d.arabicForm?(this.isRTL=!0,this.isArabic=!0,"undefined"==typeof this.glyphs[d.unicode]&&(this.glyphs[d.unicode]=[]),this.glyphs[d.unicode][d.arabicForm]=d):this.glyphs[d.unicode]=d)}},c.Element.font.prototype=new c.Element.ElementBase,c.Element.fontface=function(a){this.base=c.Element.ElementBase,this.base(a),this.ascent=this.attribute("ascent").value,this.descent=this.attribute("descent").value,this.unitsPerEm=this.attribute("units-per-em").numValue()},c.Element.fontface.prototype=new c.Element.ElementBase,c.Element.missingglyph=function(a){this.base=c.Element.path,this.base(a),this.horizAdvX=0},c.Element.missingglyph.prototype=new c.Element.path,c.Element.glyph=function(a){this.base=c.Element.path,this.base(a),this.horizAdvX=this.attribute("horiz-adv-x").numValue(),this.unicode=this.attribute("unicode").value,this.arabicForm=this.attribute("arabic-form").value},c.Element.glyph.prototype=new c.Element.path,c.Element.text=function(a){this.captureTextNodes=!0,this.base=c.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a);var b=this.style("dominant-baseline").toTextBaseline();null==b&&(b=this.style("alignment-baseline").toTextBaseline()),null!=b&&(a.textBaseline=b)},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),d=this.parent.style("font-size").numValueOrDefault(c.Font.Parse(c.ctx.font).fontSize);return new c.BoundingBox(a,b-d,a+Math.floor(2*d/3)*this.children[0].getText().length,b)},this.renderChildren=function(a){this.x=this.attribute("x").toPixels("x"),this.y=this.attribute("y").toPixels("y"),this.x+=this.getAnchorDelta(a,this,0);for(var b=0;b<this.children.length;b++)this.renderChild(a,this,b)},this.getAnchorDelta=function(a,b,c){var d=this.style("text-anchor").valueOrDefault("start");if("start"!=d){for(var e=0,f=c;f<b.children.length;f++){var g=b.children[f];if(f>c&&g.attribute("x").hasValue())break;e+=g.measureTextRecursive(a)}return-1*("end"==d?e:e/2)}return 0},this.renderChild=function(a,b,c){var d=b.children[c];d.attribute("x").hasValue()?(d.x=d.attribute("x").toPixels("x")+this.getAnchorDelta(a,b,c),d.attribute("dx").hasValue()&&(d.x+=d.attribute("dx").toPixels("x"))):(this.attribute("dx").hasValue()&&(this.x+=this.attribute("dx").toPixels("x")),d.attribute("dx").hasValue()&&(this.x+=d.attribute("dx").toPixels("x")),d.x=this.x),this.x=d.x+d.measureText(a),d.attribute("y").hasValue()?(d.y=d.attribute("y").toPixels("y"),d.attribute("dy").hasValue()&&(d.y+=d.attribute("dy").toPixels("y"))):(this.attribute("dy").hasValue()&&(this.y+=this.attribute("dy").toPixels("y")),d.attribute("dy").hasValue()&&(this.y+=d.attribute("dy").toPixels("y")),d.y=this.y),this.y=d.y,d.render(a);for(var c=0;c<d.children.length;c++)this.renderChild(a,d,c)}},c.Element.text.prototype=new c.Element.RenderedElementBase,c.Element.TextElementBase=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.getGlyph=function(a,b,c){var d=b[c],e=null;if(a.isArabic){var f="isolated";(0==c||" "==b[c-1])&&c<b.length-2&&" "!=b[c+1]&&(f="terminal"),c>0&&" "!=b[c-1]&&c<b.length-2&&" "!=b[c+1]&&(f="medial"),c>0&&" "!=b[c-1]&&(c==b.length-1||" "==b[c+1])&&(f="initial"),"undefined"!=typeof a.glyphs[d]&&(e=a.glyphs[d][f],null==e&&"glyph"==a.glyphs[d].type&&(e=a.glyphs[d]))}else e=a.glyphs[d];return null==e&&(e=a.missingGlyph),e},this.renderChildren=function(a){var b=this.parent.style("font-family").getDefinition();if(null==b)""!=a.fillStyle&&a.fillText(c.compressSpaces(this.getText()),this.x,this.y),""!=a.strokeStyle&&a.strokeText(c.compressSpaces(this.getText()),this.x,this.y);else{var d=this.parent.style("font-size").numValueOrDefault(c.Font.Parse(c.ctx.font).fontSize),e=this.parent.style("font-style").valueOrDefault(c.Font.Parse(c.ctx.font).fontStyle),f=this.getText();b.isRTL&&(f=f.split("").reverse().join(""));for(var g=c.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(b,f,h),j=d/b.fontFace.unitsPerEm;a.translate(this.x,this.y),a.scale(j,-j);var k=a.lineWidth;a.lineWidth=a.lineWidth*b.fontFace.unitsPerEm/d,"italic"==e&&a.transform(1,0,.4,1,0,0),i.render(a),"italic"==e&&a.transform(1,0,-.4,1,0,0),a.lineWidth=k,a.scale(1/j,-1/j),a.translate(-this.x,-this.y),this.x+=d*(i.horizAdvX||b.horizAdvX)/b.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(this.x+=g[h])}}},this.getText=function(){},this.measureTextRecursive=function(a){for(var b=this.measureText(a),c=0;c<this.children.length;c++)b+=this.children[c].measureTextRecursive(a);return b},this.measureText=function(a){var b=this.parent.style("font-family").getDefinition();if(null!=b){var d=this.parent.style("font-size").numValueOrDefault(c.Font.Parse(c.ctx.font).fontSize),e=0,f=this.getText();b.isRTL&&(f=f.split("").reverse().join(""));for(var g=c.ToNumberArray(this.parent.attribute("dx").value),h=0;h<f.length;h++){var i=this.getGlyph(b,f,h);e+=(i.horizAdvX||b.horizAdvX)*d/b.fontFace.unitsPerEm,"undefined"==typeof g[h]||isNaN(g[h])||(e+=g[h])}return e}var j=c.compressSpaces(this.getText());if(!a.measureText)return 10*j.length;a.save(),this.setContext(a);var k=a.measureText(j).width;return a.restore(),k}},c.Element.TextElementBase.prototype=new c.Element.RenderedElementBase,c.Element.tspan=function(a){this.captureTextNodes=!0,this.base=c.Element.TextElementBase,this.base(a),this.text=c.compressSpaces(a.value||a.text||a.textContent||""),this.getText=function(){return this.children.length>0?"":this.text}},c.Element.tspan.prototype=new c.Element.TextElementBase,c.Element.tref=function(a){this.base=c.Element.TextElementBase,this.base(a),this.getText=function(){var a=this.getHrefAttribute().getDefinition();return null!=a?a.children[0].getText():void 0}},c.Element.tref.prototype=new c.Element.TextElementBase,c.Element.a=function(a){this.base=c.Element.TextElementBase,this.base(a),this.hasText=a.childNodes.length>0;for(var b=0;b<a.childNodes.length;b++)3!=a.childNodes[b].nodeType&&(this.hasText=!1);this.text=this.hasText?a.childNodes[0].value:"",this.getText=function(){return this.text},this.baseRenderChildren=this.renderChildren,this.renderChildren=function(a){if(this.hasText){this.baseRenderChildren(a);var b=new c.Property("fontSize",c.Font.Parse(c.ctx.font).fontSize);c.Mouse.checkBoundingBox(this,new c.BoundingBox(this.x,this.y-b.toPixels("y"),this.x+this.measureText(a),this.y))}else if(this.children.length>0){var d=new c.Element.g;d.children=this.children,d.parent=this,d.render(a)}},this.onclick=function(){window.open(this.getHrefAttribute().value)},this.onmousemove=function(){c.ctx.canvas.style.cursor="pointer"}},c.Element.a.prototype=new c.Element.TextElementBase,c.Element.image=function(a){this.base=c.Element.RenderedElementBase,this.base(a);var d=this.getHrefAttribute().value;if(""!=d){var e=d.match(/\.svg$/);if(c.Images.push(this),this.loaded=!1,e)h(d).then(function(a){this.img=a,this.loaded=!0}.bind(this));else{this.img=document.createElement("img"),1==c.opts.useCORS&&(this.img.crossOrigin="Anonymous");var f=this;this.img.onload=function(){f.loaded=!0},this.img.onerror=function(){c.log('ERROR: image "'+d+'" not found'),f.loaded=!0},this.img.src=d}this.drawSvg=function(a,c,d,e,f){b.exports.parse(a.canvas,this.img,{ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0,ignoreClear:!0,offsetX:c,offsetY:d,scaleWidth:e,scaleHeight:f})},this.renderChildren=function(a){var b=this.attribute("x").toPixels("x"),d=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");0!=f&&0!=g&&(a.save(),e?this.drawSvg(a,b,d,f,g):(a.translate(b,d),c.AspectRatio(a,this.attribute("preserveAspectRatio").value,f,this.img.width,g,this.img.height,0,0),a.drawImage(this.img,0,0)),a.restore())},this.getBoundingBox=function(){var a=this.attribute("x").toPixels("x"),b=this.attribute("y").toPixels("y"),d=this.attribute("width").toPixels("x"),e=this.attribute("height").toPixels("y");return new c.BoundingBox(a,b,a+d,b+e)}}},c.Element.image.prototype=new c.Element.RenderedElementBase,c.Element.g=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.getBoundingBox=function(){for(var a=new c.BoundingBox,b=0;b<this.children.length;b++)a.addBoundingBox(this.children[b].getBoundingBox());return a}},c.Element.g.prototype=new c.Element.RenderedElementBase,c.Element.symbol=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.render=function(a){}},c.Element.symbol.prototype=new c.Element.RenderedElementBase,c.Element.style=function(a){this.base=c.Element.ElementBase,this.base(a);for(var b="",e=0;e<a.childNodes.length;e++)b+=a.childNodes[e].data;b=b.replace(/(\/\*([^*]|[\r\n]|(\*+([^*\/]|[\r\n])))*\*+\/)|(^[\s]*\/\/.*)/gm,""),b=c.compressSpaces(b);for(var f=b.split("}"),e=0;e<f.length;e++)if(""!=c.trim(f[e]))for(var g=f[e].split("{"),i=g[0].split(","),j=g[1].split(";"),k=0;k<i.length;k++){var l=c.trim(i[k]);if(""!=l){for(var m={},n=0;n<j.length;n++){var o=j[n].indexOf(":"),p=j[n].substr(0,o),q=j[n].substr(o+1,j[n].length-o);null!=p&&null!=q&&(m[c.trim(p)]=new c.Property(c.trim(p),c.trim(q)))}if(c.Styles[l]=m,c.StylesSpecificity[l]=d(l),"@font-face"==l)for(var r=m["font-family"].value.replace(/"/g,""),s=m.src.value.split(","),t=0;t<s.length;t++)if(s[t].indexOf('format("svg")')>0){var u=s[t].indexOf("url"),v=s[t].indexOf(")",u),w=s[t].substr(u+5,v-u-6);h(w).then(function(a){a=c.parseXml(a);for(var b=a.getElementsByTagName("font"),d=0;d<b.length;d++){var e=c.CreateElement(b[d]);c.Definitions[r]=e}})}}}},c.Element.style.prototype=new c.Element.ElementBase,c.Element.use=function(a){this.base=c.Element.RenderedElementBase,this.base(a),this.baseSetContext=this.setContext,this.setContext=function(a){this.baseSetContext(a),this.attribute("x").hasValue()&&a.translate(this.attribute("x").toPixels("x"),0),this.attribute("y").hasValue()&&a.translate(0,this.attribute("y").toPixels("y"))};var b=this.getHrefAttribute().getDefinition();this.path=function(a){null!=b&&b.path(a)},this.getBoundingBox=function(){return null!=b?b.getBoundingBox():void 0},this.renderChildren=function(a){if(null!=b){var d=b;"symbol"==b.type&&(d=new c.Element.svg,d.type="svg",d.attributes.viewBox=new c.Property("viewBox",b.attribute("viewBox").value),d.attributes.preserveAspectRatio=new c.Property("preserveAspectRatio",b.attribute("preserveAspectRatio").value),d.attributes.overflow=new c.Property("overflow",b.attribute("overflow").value),d.children=b.children),"svg"==d.type&&(this.attribute("width").hasValue()&&(d.attributes.width=new c.Property("width",this.attribute("width").value)),this.attribute("height").hasValue()&&(d.attributes.height=new c.Property("height",this.attribute("height").value)));var e=d.parent;d.parent=null,d.render(a),d.parent=e}}},c.Element.use.prototype=new c.Element.RenderedElementBase,c.Element.mask=function(a){this.base=c.Element.ElementBase,this.base(a),this.apply=function(a,b){var d=this.attribute("x").toPixels("x"),e=this.attribute("y").toPixels("y"),f=this.attribute("width").toPixels("x"),g=this.attribute("height").toPixels("y");if(0==f&&0==g){for(var h=new c.BoundingBox,i=0;i<this.children.length;i++)h.addBoundingBox(this.children[i].getBoundingBox());var d=Math.floor(h.x1),e=Math.floor(h.y1),f=Math.floor(h.width),g=Math.floor(h.height)}var j=b.attribute("mask").value;b.attribute("mask").value="";var k=document.createElement("canvas");k.width=d+f,k.height=e+g;var l=k.getContext("2d");c.CanvasBoundingBox.freeze=!0,this.renderChildren(l),c.CanvasBoundingBox.freeze=!1;var m=document.createElement("canvas");m.width=d+f,m.height=e+g;var n=m.getContext("2d");c.CanvasBoundingBox.freeze=!0,b.render(n),c.CanvasBoundingBox.freeze=!1,n.globalCompositeOperation="destination-in",n.fillStyle=l.createPattern(k,"no-repeat"),n.fillRect(0,0,d+f,e+g),a.fillStyle=n.createPattern(m,"no-repeat"),a.fillRect(0,0,d+f,e+g),b.attribute("mask").value=j},this.render=function(a){}},c.Element.mask.prototype=new c.Element.ElementBase,c.Element.clipPath=function(a){this.base=c.Element.ElementBase,this.base(a),this.apply=function(a){var b=CanvasRenderingContext2D.prototype.beginPath;CanvasRenderingContext2D.prototype.beginPath=function(){};var d=CanvasRenderingContext2D.prototype.closePath;CanvasRenderingContext2D.prototype.closePath=function(){},b.call(a);for(var e=0;e<this.children.length;e++){var f=this.children[e];if("undefined"!=typeof f.path){var g=null;f.attribute("transform").hasValue()&&(g=new c.Transform(f.attribute("transform").value),g.apply(a)),f.path(a),CanvasRenderingContext2D.prototype.closePath=d,g&&g.unapply(a)}}d.call(a),a.clip(),CanvasRenderingContext2D.prototype.beginPath=b,CanvasRenderingContext2D.prototype.closePath=d;
},this.render=function(a){}},c.Element.clipPath.prototype=new c.Element.ElementBase,c.Element.filter=function(a){this.base=c.Element.ElementBase,this.base(a),this.apply=function(a,b){var c=b.getBoundingBox(),d=Math.floor(c.x1),e=Math.floor(c.y1),f=Math.floor(c.width),g=Math.floor(c.height),h=b.style("filter").value;b.style("filter").value="";for(var i=0,j=0,k=0;k<this.children.length;k++){var l=this.children[k].extraFilterDistance||0;i=Math.max(i,l),j=Math.max(j,l)}var m=document.createElement("canvas");m.width=f+2*i,m.height=g+2*j;var n=m.getContext("2d");n.translate(-d+i,-e+j),b.render(n);for(var k=0;k<this.children.length;k++)this.children[k].apply(n,0,0,f+2*i,g+2*j);a.drawImage(m,0,0,f+2*i,g+2*j,d-i,e-j,f+2*i,g+2*j),b.style("filter",!0).value=h},this.render=function(a){}},c.Element.filter.prototype=new c.Element.ElementBase,c.Element.feMorphology=function(a){this.base=c.Element.ElementBase,this.base(a),this.apply=function(a,b,c,d,e){}},c.Element.feMorphology.prototype=new c.Element.ElementBase,c.Element.feComposite=function(a){this.base=c.Element.ElementBase,this.base(a),this.apply=function(a,b,c,d,e){}},c.Element.feComposite.prototype=new c.Element.ElementBase,c.Element.feColorMatrix=function(a){function b(a,b,c,d,e,f){return a[c*d*4+4*b+f]}function d(a,b,c,d,e,f,g){a[c*d*4+4*b+f]=g}function e(a,b){var c=f[a];return c*(0>c?b-255:b)}this.base=c.Element.ElementBase,this.base(a);var f=c.ToNumberArray(this.attribute("values").value);switch(this.attribute("type").valueOrDefault("matrix")){case"saturate":var g=f[0];f=[.213+.787*g,.715-.715*g,.072-.072*g,0,0,.213-.213*g,.715+.285*g,.072-.072*g,0,0,.213-.213*g,.715-.715*g,.072+.928*g,0,0,0,0,0,1,0,0,0,0,0,1];break;case"hueRotate":var h=f[0]*Math.PI/180,i=function(a,b,c){return a+Math.cos(h)*b+Math.sin(h)*c};f=[i(.213,.787,-.213),i(.715,-.715,-.715),i(.072,-.072,.928),0,0,i(.213,-.213,.143),i(.715,.285,.14),i(.072,-.072,-.283),0,0,i(.213,-.213,-.787),i(.715,-.715,.715),i(.072,.928,.072),0,0,0,0,0,1,0,0,0,0,0,1];break;case"luminanceToAlpha":f=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,.2125,.7154,.0721,0,0,0,0,0,0,1]}this.apply=function(a,c,f,g,h){for(var i=a.getImageData(0,0,g,h),f=0;h>f;f++)for(var c=0;g>c;c++){var j=b(i.data,c,f,g,h,0),k=b(i.data,c,f,g,h,1),l=b(i.data,c,f,g,h,2),m=b(i.data,c,f,g,h,3);d(i.data,c,f,g,h,0,e(0,j)+e(1,k)+e(2,l)+e(3,m)+e(4,1)),d(i.data,c,f,g,h,1,e(5,j)+e(6,k)+e(7,l)+e(8,m)+e(9,1)),d(i.data,c,f,g,h,2,e(10,j)+e(11,k)+e(12,l)+e(13,m)+e(14,1)),d(i.data,c,f,g,h,3,e(15,j)+e(16,k)+e(17,l)+e(18,m)+e(19,1))}a.clearRect(0,0,g,h),a.putImageData(i,0,0)}},c.Element.feColorMatrix.prototype=new c.Element.ElementBase,c.Element.feGaussianBlur=function(a){this.base=c.Element.ElementBase,this.base(a),this.blurRadius=Math.floor(this.attribute("stdDeviation").numValue()),this.extraFilterDistance=this.blurRadius,this.apply=function(a,b,d,e,f){return"undefined"==typeof stackBlurCanvasRGBA?void c.log("ERROR: StackBlur.js must be included for blur to work"):(a.canvas.id=c.UniqueId(),a.canvas.style.display="none",document.body.appendChild(a.canvas),stackBlurCanvasRGBA(a.canvas.id,b,d,e,f,this.blurRadius),void document.body.removeChild(a.canvas))}},c.Element.feGaussianBlur.prototype=new c.Element.ElementBase,c.Element.title=function(a){},c.Element.title.prototype=new c.Element.ElementBase,c.Element.desc=function(a){},c.Element.desc.prototype=new c.Element.ElementBase,c.Element.MISSING=function(a){c.log("ERROR: Element '"+a.nodeName+"' not yet implemented.")},c.Element.MISSING.prototype=new c.Element.ElementBase,c.CreateElement=function(a){var b=a.nodeName.replace(/^[^:]+:/,"");b=b.replace(/\-/g,"");var d=null;return d="undefined"!=typeof c.Element[b]?new c.Element[b](a):new c.Element.MISSING(a),d.type=a.nodeName,d},c.loadXml=function(a,b){c.loadXmlDoc(a,c.parseXml(b))},c.loadXmlDoc=function(a,b){if("svg"!==b.nodeName){if(!(b.children.length>0||"svg"!==b.children[0].nodeName))throw new Error("ERROR: File missing SVG declaration");b=b.children[0]}c.init(a);var d=c.CreateElement(b);d.root=!0,d.addStylesFromStyleDefinition();var e=!0,f=function(){c.ViewPort.Clear(),a.canvas.parentNode?c.ViewPort.SetCurrent(a.canvas.parentNode.clientWidth,a.canvas.parentNode.clientHeight):b.parentNode&&c.ViewPort.SetCurrent(b.parentNode.clientWidth,b.parentNode.clientHeight),1!=c.opts.ignoreDimensions&&(d.style("width").hasValue()&&(a.canvas.width=d.style("width").toPixels("x"),a.canvas.style.width=a.canvas.width+"px"),d.style("height").hasValue()&&(a.canvas.height=d.style("height").toPixels("y"),a.canvas.style.height=a.canvas.height+"px"));var f=a.canvas.clientWidth||a.canvas.width,g=a.canvas.clientHeight||a.canvas.height;if(1==c.opts.ignoreDimensions&&d.style("width").hasValue()&&d.style("height").hasValue()&&(f=d.style("width").toPixels("x"),g=d.style("height").toPixels("y")),c.ViewPort.SetCurrent(f,g),null!=c.opts.offsetX&&(d.attribute("x",!0).value=c.opts.offsetX),null!=c.opts.offsetY&&(d.attribute("y",!0).value=c.opts.offsetY),null!=c.opts.scaleWidth||null!=c.opts.scaleHeight){var h=null,i=null,j=c.ToNumberArray(d.attribute("viewBox").value);null!=c.opts.scaleWidth&&(d.attribute("width").hasValue()?h=d.attribute("width").toPixels("x")/c.opts.scaleWidth:isNaN(j[2])||(h=j[2]/c.opts.scaleWidth)),null!=c.opts.scaleHeight&&(d.attribute("height").hasValue()?i=d.attribute("height").toPixels("y")/c.opts.scaleHeight:isNaN(j[3])||(i=j[3]/c.opts.scaleHeight)),null==h&&(h=i),null==i&&(i=h),d.attribute("width",!0).value=c.opts.scaleWidth,d.attribute("height",!0).value=c.opts.scaleHeight,d.attribute("transform",!0).value+=" scale("+1/h+","+1/i+")"}1!=c.opts.ignoreClear&&a.clearRect(0,0,f,g),d.render(a),"visible"===d.style("overflow"),e&&(e=!1,"function"==typeof c.opts.renderCallback&&c.opts.renderCallback({element:b,bounds:c.CanvasBoundingBox}))},g=!0;c.ImagesLoaded()&&(g=!1,f()),c.intervalID=setInterval(function(){var a=!1;if(g&&c.ImagesLoaded()&&(g=!1,a=!0),1!=c.opts.ignoreMouse&&(a|=c.Mouse.hasEvents()),1!=c.opts.ignoreAnimation)for(var b=0;b<c.Animations.length;b++)a|=c.Animations[b].update(1e3/c.FRAMERATE);"function"==typeof c.opts.forceRedraw&&1==c.opts.forceRedraw()&&(a=!0),a&&(f(),c.Mouse.runEvents())},1e3/c.FRAMERATE)},c.stop=function(){c.intervalID&&clearInterval(c.intervalID)},c.Mouse=new function(){this.events=[],this.hasEvents=function(){return 0!=this.events.length},this.onclick=function(a,b){this.events.push({type:"onclick",x:a,y:b,run:function(a){a.onclick&&a.onclick()}})},this.onmousemove=function(a,b){this.events.push({type:"onmousemove",x:a,y:b,run:function(a){a.onmousemove&&a.onmousemove()}})},this.eventElements=[],this.checkPath=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInPath&&b.isPointInPath(d.x,d.y)&&(this.eventElements[c]=a)}},this.checkBoundingBox=function(a,b){for(var c=0;c<this.events.length;c++){var d=this.events[c];b.isPointInBox(d.x,d.y)&&(this.eventElements[c]=a)}},this.runEvents=function(){c.ctx.canvas.style.cursor="";for(var a=0;a<this.events.length;a++)for(var b=this.events[a],d=this.eventElements[a];d;)b.run(d),d=d.parent;this.events=[],this.eventElements=[]}},c}var f=a("../color"),g=a("../log"),h=a("../xhr"),j=a("../BoundingBox");b.exports.parse=function(a,c,d){if(null!=a||null!=c||null!=d){"string"==typeof a&&(a=document.getElementById(a)),null!=a.svg&&a.svg.stop();var f=e(d||{});(1!=a.childNodes.length||"OBJECT"!=a.childNodes[0].nodeName)&&(a.svg=f);var g=a.getContext("2d");"undefined"!=typeof c.nodeName?f.loadXmlDoc(g,c):f.loadXml(g,c)}else for(var h=document.querySelectorAll("svg"),i=0;i<h.length;i++){var j=h[i],k=document.createElement("canvas");k.width=j.clientWidth,k.height=j.clientHeight,j.parentNode.insertBefore(k,j),j.parentNode.removeChild(j);var l=document.createElement("div");l.appendChild(j),b.exports.parse(k,l.innerHTML)}};var k;k="undefined"!=typeof Element.prototype.matches?function(a,b){return a.matches(b)}:"undefined"!=typeof Element.prototype.webkitMatchesSelector?function(a,b){return a.webkitMatchesSelector(b)}:"undefined"!=typeof Element.prototype.mozMatchesSelector?function(a,b){return a.mozMatchesSelector(b)}:"undefined"!=typeof Element.prototype.msMatchesSelector?function(a,b){return a.msMatchesSelector(b)}:"undefined"!=typeof Element.prototype.oMatchesSelector?function(a,b){return a.oMatchesSelector(b)}:Sizzle.matchesSelector;var l=/(\[[^\]]+\])/g,m=/(#[^\s\+>~\.\[:]+)/g,n=/(\.[^\s\+>~\.\[:]+)/g,o=/(::[^\s\+>~\.\[:]+|:first-line|:first-letter|:before|:after)/gi,p=/(:[\w-]+\([^\)]*\))/gi,q=/(:[^\s\+>~\.\[:]+)/g,r=/([^\s\+>~\.\[:]+)/g},{"../BoundingBox":5,"../color":7,"../log":19,"../xhr":35}],33:[function(a,b,c){function d(a,b){f.call(this,a,b)}function e(a,b,c){return a.length>0?b+c.toUpperCase():void 0}var f=a("./nodecontainer");d.prototype=Object.create(f.prototype),d.prototype.applyTextTransform=function(){this.node.data=this.transform(this.parent.css("textTransform"))},d.prototype.transform=function(a){var b=this.node.data;switch(a){case"lowercase":return b.toLowerCase();case"capitalize":return b.replace(/(^|\s|:|-|\(|\))([a-z])/g,e);case"uppercase":return b.toUpperCase();default:return b}},b.exports=d},{"./nodecontainer":20}],34:[function(a,b,c){var d=a("./BoundingBox");c.smallImage=function(){return"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},c.bind=function(a,b){return function(){return a.apply(b,arguments)}},c.decode64=a("base64-arraybuffer").decode,c.getBounds=function(a){if(a.getBoundingClientRect){var b=a.getBoundingClientRect(),c=null==a.offsetWidth?b.width:a.offsetWidth;return new d(b.left,b.top,b.left+c,b.bottom||b.top+b.height)}return new d},c.offsetBounds=function(a){var b=a.offsetParent?c.offsetBounds(a.offsetParent):{y:0,x:0};return new d(a.offsetLeft+b.x,a.offsetTop+b.y,a.offsetLeft+b.x+a.offsetWidth,a.offsetTop+a.offsetHeight+b.y)},c.parseBackgrounds=function(a){var b,c,d,e,f,g,h,i=" \r\n	",j=[],k=0,l=0,m=function(){b&&('"'===c.substr(0,1)&&(c=c.substr(1,c.length-2)),c&&h.push(c),"-"===b.substr(0,1)&&(e=b.indexOf("-",1)+1)>0&&(d=b.substr(0,e),b=b.substr(e)),j.push({prefix:d,method:b.toLowerCase(),value:f,args:h,image:null})),h=[],b=d=c=f=""};return h=[],b=d=c=f="",a.split("").forEach(function(a){if(!(0===k&&i.indexOf(a)>-1)){switch(a){case'"':g?g===a&&(g=null):g=a;break;case"(":if(g)break;if(0===k)return k=1,void(f+=a);l++;break;case")":if(g)break;if(1===k){if(0===l)return k=0,f+=a,void m();l--}break;case",":if(g)break;if(0===k)return void m();if(1===k&&0===l&&!b.match(/^url$/i))return h.push(c),c="",void(f+=a)}f+=a,0===k?b+=a:c+=a}}),m(),j}},{"./BoundingBox":5,"base64-arraybuffer":1}],35:[function(a,b,c){function d(a){return new e(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.onload=function(){200===d.status?b(d.responseText):c(new Error(d.statusText))},d.onerror=function(){c(new Error("Network Error"))},d.send()})}var e=a("./promise");b.exports=d},{"./promise":22}]},{},[18])(18)});